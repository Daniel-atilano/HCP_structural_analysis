---
title: "HCP_racial_identity_analysis_rev"
author: "daniel atilano"
date: "30/4/2022"
output: github_document
---
```{r setup2, include=FALSE}
library(readr)
library(tidyr)
library(dplyr)
library(ggplot2)
library(rmdformats)
library(gtsummary)
library(gt)
library(lmPerm)
library(gghalves)
library(ggsignif)
library(car)
```


# 1. Exclusion criteria 

#### Exclusion variables from HCP restricted database that include Tier 1 and Tier 2 variables. Variables description can be consulted at https://wiki.humanconnectome.org/display/PublicData/HCP-YA+Data+Dictionary-+Updated+for+the+1200+Subject+Release

#### The database download date was 03/17/2021

### Exclusion criteria for the HCP-1200 restricted database: 
          
        1. Hypothyroidism (Exclusion of Afirmative Responses: YES = 1).
        2. Hyperthyroidism (Exclusion of Afirmative Responses: YES = 1).
        3. Using birth control pills, progesterone, or fertility drugs (Exclusion of Afirmative Responses: YES = 1).
        4. Menstrual Regular cycles (Exclusion of Negative Responses: NO = 0 ).

### Achenbach Adult Self Report

        5. ASR DSM-Depresive problems (Exclusion of T Scores > 65)
        6. ASR DSM-Anxiety problems (Exclusion of T Scores > 65)
        7. ASR DSM-Somatic problems (Exclusion of T Scores > 65)
        8. ASR DSM- Avoidant personality problems (Exclusion of T Scores > 65)
        9. ASR DSM Attention deficit and hyperactivity problems (Exclusion of T Scores > 65)
        10. ASR DSM Antisocial personality problems (Exclusion of T Scores > 65)
### SSAGA
        11. Presence of panic disorders at some time in life (Exclusion of responses:1=Yes)
        12. Presence of agoraphobia disorder at some point in life (Exclusion of responses:5=Yes)

### Drug Consumption

        13. Alcohol consumption above 0.05 using breath analyzer (Exclusion of responses = TRUE).
        14. Alcohol consumption above 0.08 using a breath analyzer (Exclusion of responses = TRUE).
        15. Cocaine consumption (Exclusion of responses = TRUE).
        16. THC consumption (Exclusion of responses = TRUE)
        17. Opioids consumption (Exclusion of responses = TRUE).
        18. Amphetamine consumption (Exclusion of responses = TRUE).
        19. Methamphetamine consumption (Exclusion of responses = TRUE).
        20. Oxycontin consumption (Exclusion of responses = TRUE).
        21. SSAGA DSM-IV Alcohol abuse at some point in life (Exclusion of responses: 5=YES).
        22. Fagerstrom Test nicotine dependence (Exclusion of Scores >= 6)
        23. Acquired Freesurfer measures 
        24. Subjects with brain structural abnormalities (coded A-B) found in the HCP Quality Control process.  
        
For more information related to brain structural abnormalities, see the <a href=\https://wiki.humanconnectome.org/x/14dMBQ\">QC Issues wiki</a>:  A= Focal anatomical anomaly (e.g. calcification, cavernoma, cyst, etc.) found in T1w and/or T2w scans in a restricted brain region; B= Focal segmentation or surface   error(s) in outputs from the HCP Structural pipeline

# 2. Filtering process

#### Variable description: 
##### data_connectome_complete = restricted HCP-1200_database downloaded from  https://db.humanconnectome.org/ 
##### data_connectome_filtered = filtered database according to the exlusion criteria mention above

```{r include=FALSE}

data_connectome_complete <- read_csv("data_connectomehcp_complete.csv")

#data_connectome_filtered <- read_csv(" data_connectomehcp_complete_filtered.csv")
```


```{r}
data_connectome_filtered <- data_connectome_complete %>%  dplyr::filter(
    is.na(Hypothyroidism)|Hypothyroidism!=1,
    is.na(Hyperthyroidism)|Hyperthyroidism!=1,
    is.na(OtherEndocrn_Prob)|OtherEndocrn_Prob!=1,
    is.na(Menstrual_UsingBirthControl)|Menstrual_UsingBirthControl !=1,
    is.na(Menstrual_RegCycles)|Menstrual_RegCycles !=0,
    is.na(DSM_Depr_T)|DSM_Depr_T<=69,
    is.na(DSM_Anxi_T)|DSM_Anxi_T<=69,
    is.na(DSM_Somp_T)|DSM_Somp_T<=69,
    is.na(DSM_Avoid_T)|DSM_Avoid_T<=69,
    is.na(DSM_Adh_T)|DSM_Adh_T<=69,
    is.na(DSM_Antis_T)|DSM_Antis_T<=69,
    is.na(SSAGA_PanicDisorder)|SSAGA_PanicDisorder !=1,
    is.na(SSAGA_Agoraphobia)|SSAGA_Agoraphobia !=5,
    is.na(Breathalyzer_Over_05)|Breathalyzer_Over_05 == "FALSE",
    is.na(Breathalyzer_Over_08)|Breathalyzer_Over_08 == "FALSE",
    is.na(Cocaine)|Cocaine == "FALSE",
    is.na(THC)|THC == "FALSE",
    is.na(Opiates)|Opiates == "FALSE",
    is.na(Amphetamines)|Amphetamines == "FALSE",
    is.na(MethAmphetamine)|MethAmphetamine == "FALSE",
    is.na(Oxycontin)|Oxycontin == "FALSE",
    is.na(SSAGA_Alc_D4_Ab_Dx)|SSAGA_Alc_D4_Ab_Dx == 1,
    is.na(SSAGA_FTND_Score)|SSAGA_FTND_Score < 6,
    FS_IntraCranial_Vol >0,
    is.na(QC_Issue)|QC_Issue %in% c("C", "C D", "C D E")
    )
```


## Racial and ethnic identity frecuencies 

```{r fig.align="center", echo = FALSE,fig.width = 10}
ggplot(data_connectome_filtered, aes(Race, fill = Ethnicity)) + geom_bar()+
    geom_text(aes(label=..count..),stat="count",position=position_stack(0.5), colour= "black", size = 4) + coord_flip() + xlab("Racial Identity") + theme( aspect.ratio = .5,legend.position="top", legend.title = element_text(color = "black", size = 13, face = "bold"),
  legend.text = element_text(color = "black", size = 12)) +  theme(axis.text.x = element_text(face="bold", 
                           size=12),
          axis.text.y = element_text(face="bold", 
                           size=12)) 
         # geom_bar(aes(y = (..count..)/sum(..count..))) + geom_text(aes(label = ..count.., y= ..prop..), stat= "count", vjust = -.2 ) + scale_y_continuous(labels=scales::percent) 

```

####  Ethnic identity discarded from filtered database due to under sampling and the selection of White and Black or African Americans racial identities` due to  the most representative groups.

     data_connectome_filtered_racial_identity <- data_connectome_filtered %>%  filter(Racial_identity %in% c("Black or African Am.", "White"),Ethnicity %in% c("Not Hispanic/Latino", "Unknown or Not Reported")) 

```{r echo=FALSE}

data_connectome_filtered_race <- data_connectome_filtered %>%  filter(Race %in% c("Black or African Am.", "White"),Ethnicity %in% c("Not Hispanic/Latino", "Unknown or Not Reported")) 

data_connectome_filtered_race_factor <- data_connectome_filtered_race %>% dplyr::rename(Racial_identity = Race)

#data_connectome_filtered_race_factor %>% count(Racial_identity)
```

####  Factorized GENDER, RACIAL IDENTITY, and ECONOMIC INCOME variables


    ##SSAGA_income = Total household income: <$10,000 = 1,10K-19,999 = 2, 20K-29,999 = 3,30K-39,999 = 4, 40K-49,999 = 5, 50K-74,999 = 6, 75K-99,999 = 7, >=100,000 = 8
    
    data_connectome_filtered_racial_identity$Racial_identity <- factor(data_connectome_filtered_race_factor$Racial_identity, levels = c("White","Black or African Am."),labels = c("0","1"))

    data_connectome_filtered_racial_identity$Gender <-factor(data_connectome_filtered_race_factor$Gender, levels = c("M","F"),labels = c("0","1"))

    data_connectome_filtered_racial_identityr$Gender <-factor(data_connectome_filtered_race_factor$Gender, levels = c("0","1"),labels = c("M","F"))

    data_connectome_filtered_racial_identity$Racial_identity <- factor(data_connectome_filtered_race_factor$Racial_identity, levels = c("0","1"),labels = c("White","Black or African Am."))

    data_connectome_filtered_racial_identity$SSAGA_Income <- factor(data_connectome_filtered_race_factor$SSAGA_Income, levels = c("1","2","3","4","5","6","7","8"),labels = c("<$10000","10K-19999","20K-29999","30K-39999","40K-49999", "50K-74999","75K-99999", ">=100000"))
    
```{r include=FALSE}
data_connectome_filtered_race_factor$Racial_identity <- factor(data_connectome_filtered_race_factor$Racial_identity, levels = c("White","Black or African Am."),labels = c("0","1"))

data_connectome_filtered_race_factor$Gender <-factor(data_connectome_filtered_race_factor$Gender, levels = c("M","F"),labels = c("0","1"))

data_connectome_filtered_race_factor$Gender <-factor(data_connectome_filtered_race_factor$Gender, levels = c("0","1"),labels = c("M","F"))

data_connectome_filtered_race_factor$Racial_identity <- factor(data_connectome_filtered_race_factor$Racial_identity, levels = c("0","1"),labels = c("White","Black or African Am."))

data_connectome_filtered_race_factor$SSAGA_Income <- factor(data_connectome_filtered_race_factor$SSAGA_Income, levels = c("1","2","3","4","5","6","7","8"),labels = c("<$10000","10K-19999","20K-29999","30K-39999","40K-49999", "50K-74999","75K-99999", ">=100000"))
```
    
    
#### Descriptives for filtered sample 

```{r echo=FALSE}
data_connectome_filtered_race_factor %>%      select(Age_in_Yrs,Racial_identity,Gender,SSAGA_Educ,SSAGA_Income) %>% tbl_summary(by = Racial_identity, label = list(Age_in_Yrs ~ "Age (y)", Gender ~ "Sex", SSAGA_Educ ~ "Education(y)", SSAGA_Income ~ "Economic Income "), type = list(SSAGA_Educ ~ 'continuous'), statistic = c("Age_in_Yrs", "SSAGA_Educ") ~ "{mean} ({sd})", digits = all_continuous() ~ 2) %>% add_p(pvalue_fun = ~style_pvalue(.x, digits = 3), list(all_continuous() ~ "t.test")) %>%  add_n() %>%     modify_caption("**Table 1. Descriptives for racial identity**") %>% modify_header(label ~ "")  %>%  bold_labels() %>% modify_spanning_header(all_stat_cols() ~ "**Racial Identity**") %>% as_gt()%>% opt_align_table_header(align = "left") 

##MISSING 3 VALUES FOR WHITES

```

    
# 2. Brain volume ANCOVA permutational analysis

#### Brain volumetry is corrected by intracraneal volume values taken from FreeSurfer Summery statistics. 

    volumetry_data_connectome_filtered <- data_connectome_filtered_racial_identity %>%  select(c(## Colums numbers of volumetric measures))

    # FS_IntraCranial_Vol = Free Surfer intracraneal volume measures

    volumetry_data_connectome_filtered_normalized_icv <- volumetry_data_connectome_filtered %>%  lapply(function(x) x/volumetry_data_connectome_filtered$FS_IntraCranial_Vol) %>% as.data.frame() %>% select(-1)

    # Filtered database binding with normalized brain volumetric data 

    data_connectome_filtered_with_volumetry_normalized_icv <- cbind(data_connectome_filtered_racial_identity,volumetry_data_connectome_filtered_normalized_icv) 


```{r include=FALSE}
volumetry_data_connectome_filtered <- data_connectome_filtered_race_factor %>%  select(c(393:444,450:455))

volumetry_data_connectome_filtered_normalized_icv <- volumetry_data_connectome_filtered %>%  lapply(function(x) x/volumetry_data_connectome_filtered$FS_IntraCranial_Vol) %>% as.data.frame() %>% select(-1)

# database binding with normalized brain volumetric data 

data_connectome_filtered_with_volumetry_normalized_icv <- cbind(data_connectome_filtered_race_factor,volumetry_data_connectome_filtered_normalized_icv) 

```




```{r include=FALSE}
permutational_ancova_volumetry_corrected_intracraneal <- data_connectome_filtered_with_volumetry_normalized_icv %>% dplyr::select(c(2,10,14,15,205,784:840))  %>% dplyr::rename(
    BrainSeg_Vol= FS_BrainSeg_Vol,                         
    BrainSeg_Vol_No_Vent = FS_BrainSeg_Vol_No_Vent,                  
    BrainSeg_Vol_No_Vent_Surf = FS_BrainSeg_Vol_No_Vent_Surf,
    LCort_GM_Vol = FS_LCort_GM_Vol,                         
    RCort_GM_Vol =FS_RCort_GM_Vol,
    TotCort_GM_Vol = FS_TotCort_GM_Vol, 
    SubCort_GM_Vol = FS_SubCort_GM_Vol,
    Total_GM_Vol = FS_Total_GM_Vol,
    SupraTentorial_Vol = FS_SupraTentorial_Vol,
    L_WM_Vol = FS_L_WM_Vol,
    R_WM_Vol = FS_R_WM_Vol,
    Tot_WM_Vol = FS_Tot_WM_Vol,
    Mask_Vol = FS_Mask_Vol,
    BrainSegVol_eTIV_Ratio = FS_BrainSegVol_eTIV_Ratio,
    MaskVol_eTIV_Ratio = FS_MaskVol_eTIV_Ratio,
    LH_Defect_Holes= FS_LH_Defect_Holes,
    RH_Defect_Holes = FS_RH_Defect_Holes,
    Total_Defect_Holes = FS_Total_Defect_Holes,
    LatVent_Vol = FS_L_LatVent_Vol,
    L_InfLatVent_Vol = FS_L_InfLatVent_Vol,
    L_Cerebellum_WM_Vol = FS_L_Cerebellum_WM_Vol,
    L_Cerebellum_Cort_Vol = FS_L_Cerebellum_Cort_Vol,
    L_ThalamusProper_Vol = FS_L_ThalamusProper_Vol,
    L_Caudate_Vol = FS_L_Caudate_Vol,
    L_Putamen_Vol = FS_L_Putamen_Vol,
    L_Pallidum_Vol = FS_L_Pallidum_Vol,
    "3rdVent_Vol" = FS_3rdVent_Vol,
    "4thVent_Vol" = FS_4thVent_Vol,
    BrainStem_Vol = FS_BrainStem_Vol,
    L_Hippo_Vol = FS_L_Hippo_Vol,
    L_Amygdala_Vol = FS_L_Amygdala_Vol,
    CSF_Vol = FS_CSF_Vol,
    L_AccumbensArea_Vol = FS_L_AccumbensArea_Vol,
    L_VentDC_Vol = FS_L_VentDC_Vol,
    L_Vessel_Vol = FS_L_Vessel_Vol,
    L_ChoroidPlexus_Vol = FS_L_ChoroidPlexus_Vol,
    R_LatVent_Vol= FS_R_LatVent_Vol,
    R_InfLatVent_Vol= FS_R_InfLatVent_Vol,
    R_Cerebellum_WM_Vol=FS_R_Cerebellum_WM_Vol,
    R_Cerebellum_Cort_Vol = FS_R_Cerebellum_Cort_Vol,
    R_ThalamusProper_Vol = FS_R_ThalamusProper_Vol,
    R_Caudate_Vol = FS_R_Caudate_Vol,
    R_Putamen_Vol = FS_R_Putamen_Vol,
    R_Pallidum_Vol = FS_R_Pallidum_Vol,
    R_Hippo_Vol = FS_R_Hippo_Vol,
    R_Amygdala_Vol= FS_R_Amygdala_Vol,
    R_AccumbensArea_Vol = FS_R_AccumbensArea_Vol,
    R_VentDC_Vol= FS_R_VentDC_Vol,
    R_Vessel_Vol = FS_R_Vessel_Vol,
    R_ChoroidPlexus_Vol= FS_R_ChoroidPlexus_Vol,
    "5thVent_Vol" = FS_5thVent_Vol,
    OpticChiasm_Vol = FS_OpticChiasm_Vol,
    CC_Posterior_Vol= FS_CC_Posterior_Vol,
    CC_MidPosterior_Vol= FS_CC_MidPosterior_Vol,
    CC_Central_Vol = FS_CC_Central_Vol,
    CC_MidAnterior_Vol = FS_CC_MidAnterior_Vol,
    CC_Anterior_Vol = FS_CC_Anterior_Vol)
```

#### Brain volumetry descriptives 

```{r}
permutational_ancova_volumetry_corrected_intracraneal %>% na.omit() %>% select(c(2,6:17,24:62)) %>% 
   dplyr::rename(
    "Brain Seg"= BrainSeg_Vol,                         
    "Brain Seg No Vent" = BrainSeg_Vol_No_Vent,                  
    "Brain Seg No Vent Surf" = BrainSeg_Vol_No_Vent_Surf,
    "Left Cortical GM" = LCort_GM_Vol,                         
    "Right Cortical GM" =RCort_GM_Vol,
    "Cortical GM" = TotCort_GM_Vol, 
    "Subcortical GM" = SubCort_GM_Vol,
    "Total GM" = Total_GM_Vol,
    "SupraTentorial" = SupraTentorial_Vol,
    "Left WM" = L_WM_Vol,
    "Right WM" = R_WM_Vol,
    "Total WM" = Tot_WM_Vol,
    "Left Lat Ventricle" = LatVent_Vol,
    "Left Inf Lat Ventricle" = L_InfLatVent_Vol,
    "Left Cerebellum WM" = L_Cerebellum_WM_Vol,
    "Left Cerebellum Cortex" = L_Cerebellum_Cort_Vol,
    "Left Thalamus Proper" = L_ThalamusProper_Vol,
    "Left Caudate" = L_Caudate_Vol,
    "Left Putamen" = L_Putamen_Vol,
    "Left Pallidum" = L_Pallidum_Vol,
    "3rd Ventricle" = `3rdVent_Vol`,
    "4th Ventricle" = `4thVent_Vol`,
    "Brain Stem" = BrainStem_Vol,
    "Left Hippocampus" = L_Hippo_Vol,
    "Left Amygdala"= L_Amygdala_Vol,
    "CSF" = CSF_Vol,
    "Left Accumbens Area" = L_AccumbensArea_Vol,
    "Left Vent Diencephalon" = L_VentDC_Vol,
    "Left Vessel" = L_Vessel_Vol,
    "Left Choroid Plexus" = L_ChoroidPlexus_Vol,
    "Right Lat Ventricle"= R_LatVent_Vol,
    "Right Inf Lat Ventricle"= R_InfLatVent_Vol,
    "Right Cerebellum WM"=R_Cerebellum_WM_Vol,
    "Right Cerebellum Cortex" = R_Cerebellum_Cort_Vol,
    "Right Thalamus Proper" = R_ThalamusProper_Vol,
    "Right Caudate" = R_Caudate_Vol,
    "Right Putamen" = R_Putamen_Vol,
    "Right Pallidum" = R_Pallidum_Vol,
    "Right Hippocampus" = R_Hippo_Vol,
    "Right Amygdala"= R_Amygdala_Vol,
    "Right Accumbens Area" = R_AccumbensArea_Vol,
    "Right Vent Diencephalon"= R_VentDC_Vol,
    "Right Vessel" = R_Vessel_Vol,
    "Right Choroid Plexus"= R_ChoroidPlexus_Vol,
    "5th Ventricle" = `5thVent_Vol`,
    "Optic Chiasm" = OpticChiasm_Vol,
    "CC Posterior"= CC_Posterior_Vol,
    "CC MidPosterior"= CC_MidPosterior_Vol,
    "CC Central" = CC_Central_Vol,
    "CC MidAnterior" = CC_MidAnterior_Vol,
    "CC Anterior" = CC_Anterior_Vol) %>% tbl_summary(by = Racial_identity, statistic = list(all_continuous() ~ "{mean} ({sd})"), digits = all_continuous() ~ function(x) format(x, format = "e", digits = 4)) %>%
    modify_header(label ~ "**Brain Regions**") %>% as_gt()
```

#### Permutational analysis adjusted for Age, Gender, Education (years) & Economic income

```{r echo=TRUE, message=FALSE}

# permutational_ancova_volumetry_corrected_intracraneal[,c("columns with volumetric data")]

set.seed(1234)
modpermut_volumetry_corrected_intracraneal_adjage_gender_educ_income <- lapply(permutational_ancova_volumetry_corrected_intracraneal[,c(6:17,24:62)], function(x) aovp(x ~ permutational_ancova_volumetry_corrected_intracraneal$Racial_identity+                  permutational_ancova_volumetry_corrected_intracraneal$Age_in_Yrs +                              permutational_ancova_volumetry_corrected_intracraneal$Gender + permutational_ancova_volumetry_corrected_intracraneal$SSAGA_Educ+ permutational_ancova_volumetry_corrected_intracraneal$SSAGA_Income))
```

### Brain segmentation volume

```{r}

summary(modpermut_volumetry_corrected_intracraneal_adjage_gender_educ_income$BrainSeg_Vol)

```

### Brain segmentation volume w/o ventricles

```{r}
summary(modpermut_volumetry_corrected_intracraneal_adjage_gender_educ_income$BrainSeg_Vol_No_Vent)
```

#### Brain segmentation volume w/o ventricles from surface 

```{r}
summary(modpermut_volumetry_corrected_intracraneal_adjage_gender_educ_income$BrainSeg_Vol_No_Vent_Surf)
```

#### Left hemisphere cortical gray matter volume

```{r}
summary(modpermut_volumetry_corrected_intracraneal_adjage_gender_educ_income$LCort_GM_Vol)
```

#### Right hemisphere cortical gray matter volume

```{r}
summary(modpermut_volumetry_corrected_intracraneal_adjage_gender_educ_income$RCort_GM_Vol)
```

#### Total cortical gray matter volume

```{r}
summary(modpermut_volumetry_corrected_intracraneal_adjage_gender_educ_income$TotCort_GM_Vol)
```

#### Total grey matter volume

```{r}
summary(modpermut_volumetry_corrected_intracraneal_adjage_gender_educ_income$Total_GM_Vol)
```

#### Total subcortical gray matter volume

```{r}
summary(modpermut_volumetry_corrected_intracraneal_adjage_gender_educ_income$SubCort_GM_Vol)
```

#### Supratentorial volume

```{r}
summary(modpermut_volumetry_corrected_intracraneal_adjage_gender_educ_income$SupraTentorial_Vol)
```

#### Left hemisphere cortical white matter volume

```{r}
summary(modpermut_volumetry_corrected_intracraneal_adjage_gender_educ_income$L_WM_Vol)
```

#### Right hemisphere cortical white matter volume 

```{r}
summary(modpermut_volumetry_corrected_intracraneal_adjage_gender_educ_income$R_WM_Vol)
```

#### Total cortical white matter volume 

```{r}
summary(modpermut_volumetry_corrected_intracraneal_adjage_gender_educ_income$Tot_WM_Vol)
```

#### Left lateral ventricle volume

```{r}
summary(modpermut_volumetry_corrected_intracraneal_adjage_gender_educ_income$LatVent_Vol)
```

#### Left inferior lateral ventricle volume

```{r}
summary(modpermut_volumetry_corrected_intracraneal_adjage_gender_educ_income$L_InfLatVent_Vol)
```

#### Left hemisphere cerebellum white matter volume

```{r}
summary(modpermut_volumetry_corrected_intracraneal_adjage_gender_educ_income$L_Cerebellum_WM_Vol)
```

#### Left hemisphere cerebellum cortex volume

```{r}
summary(modpermut_volumetry_corrected_intracraneal_adjage_gender_educ_income$L_Cerebellum_Cort_Vol)
```

#### Left thalamus proper volume

```{r}
summary(modpermut_volumetry_corrected_intracraneal_adjage_gender_educ_income$L_ThalamusProper_Vol)
```

#### Left caudate volume

```{r}
summary(modpermut_volumetry_corrected_intracraneal_adjage_gender_educ_income$L_Caudate_Vol)

```

#### Left putamen volume

```{r}
summary(modpermut_volumetry_corrected_intracraneal_adjage_gender_educ_income$L_Putamen_Vol)
```

#### Left pallidum volume

```{r}
summary(modpermut_volumetry_corrected_intracraneal_adjage_gender_educ_income$L_Pallidum_Vol)
```

#### 3rd ventricle volume

```{r}
summary(modpermut_volumetry_corrected_intracraneal_adjage_gender_educ_income$`3rdVent_Vol`)
```

#### 4th ventricle volume 

```{r}
summary(modpermut_volumetry_corrected_intracraneal_adjage_gender_educ_income$`4thVent_Vol`)
```

#### 5th ventricle volume

```{r}
summary(modpermut_volumetry_corrected_intracraneal_adjage_gender_educ_income$`5thVent_Vol`)
```

#### Brain stem volume

```{r}
summary(modpermut_volumetry_corrected_intracraneal_adjage_gender_educ_income$BrainStem_Vol)
```

#### Left hippocampus volume 

```{r}
summary(modpermut_volumetry_corrected_intracraneal_adjage_gender_educ_income$L_Hippo_Vol)
```

#### Left amygdala volume 

```{r}
summary(modpermut_volumetry_corrected_intracraneal_adjage_gender_educ_income$L_Amygdala_Vol)
```

#### Cerebral spinal fluid volume

```{r}
summary(modpermut_volumetry_corrected_intracraneal_adjage_gender_educ_income$CSF_Vol)
```

#### Left accumbens area volume 

```{r}
summary(modpermut_volumetry_corrected_intracraneal_adjage_gender_educ_income$L_AccumbensArea_Vol)
```

#### Left ventral diencephalon volume

```{r}
summary(modpermut_volumetry_corrected_intracraneal_adjage_gender_educ_income$L_VentDC_Vol)
```

#### Left vessel volume

```{r}
summary(modpermut_volumetry_corrected_intracraneal_adjage_gender_educ_income$L_Vessel_Vol)
```

#### Left choroid plexus volume

```{r}
summary(modpermut_volumetry_corrected_intracraneal_adjage_gender_educ_income$L_ChoroidPlexus_Vol)
```

#### Right lateral ventricle volume

```{r}
summary(modpermut_volumetry_corrected_intracraneal_adjage_gender_educ_income$R_LatVent_Vol)
```

#### Right inferior lateral ventricle volume 

```{r}
summary(modpermut_volumetry_corrected_intracraneal_adjage_gender_educ_income$R_InfLatVent_Vol)
```

#### Right hemisphere cerebellum white matter 

```{r}
summary(modpermut_volumetry_corrected_intracraneal_adjage_gender_educ_income$R_Cerebellum_WM_Vol)
```

#### Right hemisphere cerebellum cortex volume 

```{r}
summary(modpermut_volumetry_corrected_intracraneal_adjage_gender_educ_income$R_Cerebellum_Cort_Vol)
```

#### Right thalamus proper volume

```{r}
summary(modpermut_volumetry_corrected_intracraneal_adjage_gender_educ_income$R_ThalamusProper_Vol)
```

#### Right caudate volume

```{r}
summary(modpermut_volumetry_corrected_intracraneal_adjage_gender_educ_income$R_Caudate_Vol)
```

#### Right putamen volume

```{r}
summary(modpermut_volumetry_corrected_intracraneal_adjage_gender_educ_income$R_Putamen_Vol)
```

#### Right pallidum volume

```{r}
summary(modpermut_volumetry_corrected_intracraneal_adjage_gender_educ_income$R_Pallidum_Vol)
```

#### Right hippocampus volume

```{r}
summary(modpermut_volumetry_corrected_intracraneal_adjage_gender_educ_income$R_Hippo_Vol)
```

#### Right amygdala volume 

```{r}
summary(modpermut_volumetry_corrected_intracraneal_adjage_gender_educ_income$R_Amygdala_Vol)
```

#### Right accumbens area volume

```{r}
summary(modpermut_volumetry_corrected_intracraneal_adjage_gender_educ_income$R_AccumbensArea_Vol)
```

#### Right ventral diencephalon volume

```{r}
summary(modpermut_volumetry_corrected_intracraneal_adjage_gender_educ_income$R_VentDC_Vol)

```

#### Right vessel volume

```{r}
summary(modpermut_volumetry_corrected_intracraneal_adjage_gender_educ_income$R_Vessel_Vol)
```

#### Right choroid plexus volume

```{r}
summary(modpermut_volumetry_corrected_intracraneal_adjage_gender_educ_income$R_ChoroidPlexus_Vol)
```

#### Optic chiasm volume 

```{r}
summary(modpermut_volumetry_corrected_intracraneal_adjage_gender_educ_income$OpticChiasm_Vol)
```

#### Posterior corpus callosum volume

```{r}
summary(modpermut_volumetry_corrected_intracraneal_adjage_gender_educ_income$CC_Posterior_Vol)
```

#### Mid-posterior corpus callosum volume

```{r}
summary(modpermut_volumetry_corrected_intracraneal_adjage_gender_educ_income$CC_MidPosterior_Vol)
```

#### Central corpus callosum volume results

```{r}
summary(modpermut_volumetry_corrected_intracraneal_adjage_gender_educ_income$CC_Central_Vol)
```

#### Mid-anterior corpus callosum volume

```{r}
summary(modpermut_volumetry_corrected_intracraneal_adjage_gender_educ_income$CC_MidAnterior_Vol)
```

#### Anterior corpus callosum volume

```{r}
summary(modpermut_volumetry_corrected_intracraneal_adjage_gender_educ_income$CC_Anterior_Vol)
```

## Multiple comparisons correction Holm-Bonferroni method

```{r}
## Extraction of p-values of the permutational analysis permutational_ancova_volumetry_corrected_intracraneal[,c("columns with volumetric data")]

set.seed(1234)
pvalues_modpermut_volumetry_corrected_intracraneal_adjage_gender_educ_income <- sapply(permutational_ancova_volumetry_corrected_intracraneal[,c(6:17,24:62)], function(x) aovp(x ~ permutational_ancova_volumetry_corrected_intracraneal$Racial_identity+                  permutational_ancova_volumetry_corrected_intracraneal$Age_in_Yrs +                              permutational_ancova_volumetry_corrected_intracraneal$Gender + permutational_ancova_volumetry_corrected_intracraneal$SSAGA_Educ+ permutational_ancova_volumetry_corrected_intracraneal$SSAGA_Income)$perm$P)

## Conversion of p-values in a data frame format

pvalues_permutation_multiple_comparisons_volumetry <- as.data.frame(pvalues_modpermut_volumetry_corrected_intracraneal_adjage_gender_educ_income) %>% slice(2)

pvalues_permutation_multiple_comparisons_volumetry <-pvalues_permutation_multiple_comparisons_volumetry %>%  gather(key = "volumetry_corrected_ICV", value = "permutation_pvalue") 

## Execution of Holm-Bonferroni multiple comparison analysis 

pvalues_permutation_multiple_comparisons_volumetry$Holm =p.adjust(pvalues_permutation_multiple_comparisons_volumetry$permutation_pvalue,method ="holm")
```


```{r echo=FALSE}
knitr::kable(pvalues_permutation_multiple_comparisons_volumetry, format = "simple", align = "c", col.names = c('Brain regions', 'permutation p-values', 'Holm'))

pvalues_permutation_multiple_comparisons_volumetry %>% filter(Holm < 0.05)
```


### Graphs of brain regions volumes with statistical significance after multiple comparisons analysis


```{r echo=FALSE, fig.width=10}
data_volumetry_corrected_plotted <-   permutational_ancova_volumetry_corrected_intracraneal %>% na.omit()  %>% dplyr::select(c(2,12,15,16,17,28,29,41,44,47,53,55,57,58,62,49))  %>% dplyr::rename(
    #"Left Cerebellum WM***" = L_Cerebellum_WM_Vol,
    "Right Cerebellum WM***" =R_Cerebellum_WM_Vol,
    "Cortical WM***"=Tot_WM_Vol,
    "Left Cortical WM*"= L_WM_Vol,
    "Right Cortical WM***"= R_WM_Vol,
    #"Supratentorial***"=SupraTentorial_Vol,
    "Subcortical GM***"= SubCort_GM_Vol,
    #"Brain Stem***" =BrainStem_Vol,
    "Optic Chiasm***"=OpticChiasm_Vol,
    "Left Choroid Plexus***"=L_ChoroidPlexus_Vol,
    "Right Choroid Plexus***"=R_ChoroidPlexus_Vol,
    "CC Posterior***"= CC_Posterior_Vol,
    "CC Anterior***" = CC_Anterior_Vol,
    "Left Thalamus Proper***"= L_ThalamusProper_Vol,
    #"Right Thalamus Proper***"= R_ThalamusProper_Vol,
    "Right Caudate***"=R_Caudate_Vol,
    "Left Caudate***"=L_Caudate_Vol,
    #"Right Hippocampus***"=R_Hippo_Vol,
    "Right Ventral Diencephalon***"=R_VentDC_Vol,
    "Right Globus Pallidus***" = R_Pallidum_Vol) %>% gather(key = "volumetry", value = "cubic_milimeters_ICV", -Racial_identity)



plot_volumetry_corrected_permutation_facet <- ggplot(data = data_volumetry_corrected_plotted, aes(y = cubic_milimeters_ICV , x = volumetry, fill = Racial_identity)) + 
geom_half_violin((aes(fill = factor(Racial_identity))),position = position_nudge(x = .6, y = 0), alpha = .8) +
 geom_boxplot(aes(y = cubic_milimeters_ICV , x = volumetry,fill=Racial_identity), position = position_dodge(.5), notch = TRUE,outlier.shape = NA, width= 0.3, alpha =0.4, show.legend = FALSE) +  stat_summary(aes(y = cubic_milimeters_ICV , x = volumetry,fill=Racial_identity),fun.y="mean",position = position_dodge(.5), show.legend = FALSE) +  geom_point((aes(colour = factor(Racial_identity))), position = position_jitterdodge(dodge.width = 0.55), size = .5, alpha = .8, show.legend = FALSE) + 
  #coord_cartesian(ylim=c(0,0.001)) + 
  facet_wrap(~volumetry, scales = "free") +
#expand_limits(x = 6) +
#guides(fill = TRUE) +
#guides(color = TRUE) +
#scale_color_manual(values=c("red", "blue")) +
scale_fill_discrete(labels = c("Whites", "African Americans")) +
#scale_color_brewer(palette = "Spectral") +
#scale_fill_brewer(palette = "Spectral") +
#coord_flip() +
theme_light(base_size = 12, base_family = "Arial") +
  #ggtitle("Volumetric results") 
   xlab("") + ylab(~~ mm^'3'/ ICV) + labs(fill = "") + labs(col = "")  + theme(legend.position = "top",axis.text.x=element_blank(), strip.text.x = element_text(color = "black", face = "bold"))  #+ geom_signif(comparisons = list(c("White", "Black or African Am.")),tip_length=0,y_position = 9, textsize = 4)


plot_volumetry_corrected_permutation_facet

```


# 3. Brain cortical thickness ANCOVA permutational analysis

#### Permutational analysis adjusted for Age, Gender, Education (years) & Economic income


```{r include=FALSE}
permutational_ancova_cortical_thickness <- data_connectome_filtered_with_volumetry_normalized_icv %>% dplyr::select(c(2,10,14,15,205,456:523))  %>% dplyr::rename(
    L_Bankssts_Thck = FS_L_Bankssts_Thck,
    L_Caudalanteriorcingulate_Thck = FS_L_Caudalanteriorcingulate_Thck,
    L_Caudalmiddlefrontal_Thck = FS_L_Caudalmiddlefrontal_Thck,
    L_Cuneus_Thck = FS_L_Cuneus_Thck,
    L_Entorhinal_Thck = FS_L_Entorhinal_Thck,
    L_Fusiform_Thck = FS_L_Fusiform_Thck, 
    L_Inferiorparietal_Thck = FS_L_Inferiorparietal_Thck,
    L_Inferiortemporal_Thck = FS_L_Inferiortemporal_Thck,
    L_Isthmuscingulate_Thck = FS_L_Isthmuscingulate_Thck,
    L_Lateraloccipital_Thck = FS_L_Lateraloccipital_Thck,
    L_Lateralorbitofrontal_Thck = FS_L_Lateralorbitofrontal_Thck,
    L_Lingual_Thck  = FS_L_Lingual_Thck,
    L_Medialorbitofrontal_Thck = FS_L_Medialorbitofrontal_Thck,
    L_Middletemporal_Thck = FS_L_Middletemporal_Thck,
    L_Parahippocampal_Thck = FS_L_Parahippocampal_Thck,
    L_Paracentral_Thck = FS_L_Paracentral_Thck,
    L_Parsopercularis_Thck = FS_L_Parsopercularis_Thck,
    L_Parsorbitalis_Thck = FS_L_Parsorbitalis_Thck,
    L_Parstriangularis_Thck = FS_L_Parstriangularis_Thck,
    L_Pericalcarine_Thck = FS_L_Pericalcarine_Thck,
    L_Postcentral_Thck = FS_L_Postcentral_Thck,
    L_Posteriorcingulate_Thck = FS_L_Posteriorcingulate_Thck,
    L_Precentral_Thck = FS_L_Precentral_Thck,
    L_Precuneus_Thck = FS_L_Precuneus_Thck,
    L_Rostralanteriorcingulate_Thck = FS_L_Rostralanteriorcingulate_Thck,
    L_Rostralmiddlefrontal_Thck = FS_L_Rostralmiddlefrontal_Thck,
    L_Superiorfrontal_Thck = FS_L_Superiorfrontal_Thck,
    L_Superiorparietal_Thck = FS_L_Superiorparietal_Thck,
    L_Superiortemporal_Thck = FS_L_Superiortemporal_Thck,
    L_Supramarginal_Thck = FS_L_Supramarginal_Thck,
    L_Frontalpole_Thck = FS_L_Frontalpole_Thck,
    L_Temporalpole_Thck = FS_L_Temporalpole_Thck,
    L_Transversetemporal_Thck = FS_L_Transversetemporal_Thck,
    L_Insula_Thck = FS_L_Insula_Thck,
    R_Bankssts_Thck = FS_R_Bankssts_Thck,
    R_Caudalanteriorcingulate_Thck = FS_R_Caudalanteriorcingulate_Thck,
    R_Caudalmiddlefrontal_Thck = FS_R_Caudalmiddlefrontal_Thck,
    R_Cuneus_Thck = FS_R_Cuneus_Thck,
    R_Entorhinal_Thck = FS_R_Entorhinal_Thck,
    R_Fusiform_Thck = FS_R_Fusiform_Thck,
    R_Inferiorparietal_Thck = FS_R_Inferiorparietal_Thck,
    R_Inferiortemporal_Thck = FS_R_Inferiortemporal_Thck,
    R_Isthmuscingulate_Thck = FS_R_Isthmuscingulate_Thck,
    R_Lateraloccipital_Thck = FS_R_Lateraloccipital_Thck,
    R_Lateralorbitofrontal_Thck = FS_R_Lateralorbitofrontal_Thck,
    R_Lingual_Thck = FS_R_Lingual_Thck,
    R_Medialorbitofrontal_Thck = FS_R_Medialorbitofrontal_Thck,
    R_Middletemporal_Thck= FS_R_Middletemporal_Thck,
    R_Parahippocampal_Thck = FS_R_Parahippocampal_Thck,
    R_Paracentral_Thck = FS_R_Paracentral_Thck,
    R_Parsopercularis_Thck= FS_R_Parsopercularis_Thck,
    R_Parsorbitalis_Thck = FS_R_Parsorbitalis_Thck,
    R_Parstriangularis_Thck = FS_R_Parstriangularis_Thck,
    R_Pericalcarine_Thck = FS_R_Pericalcarine_Thck,
    R_Postcentral_Thck = FS_R_Postcentral_Thck,
    R_Posteriorcingulate_Thck = FS_R_Posteriorcingulate_Thck,
    R_Precentral_Thck = FS_R_Precentral_Thck,
    R_Precuneus_Thck = FS_R_Precuneus_Thck,
    R_Rostralanteriorcingulate_Thck = FS_R_Rostralanteriorcingulate_Thck,
    R_Rostralmiddlefrontal_Thck = FS_R_Rostralmiddlefrontal_Thck,
    R_Superiorfrontal_Thck = FS_R_Superiorfrontal_Thck,
    R_Superiorparietal_Thck = FS_R_Superiorparietal_Thck,
    R_Superiortemporal_Thck = FS_R_Superiortemporal_Thck,
    R_Supramarginal_Thck = FS_R_Supramarginal_Thck,
    R_Frontalpole_Thck = FS_R_Frontalpole_Thck,
    R_Temporalpole_Thck = FS_R_Temporalpole_Thck,                  
    R_Transversetemporal_Thck = FS_R_Transversetemporal_Thck,
    R_Insula_Thck = FS_R_Insula_Thck )
```

#### Brain Cortical Thickness descriptives

```{r}
permutational_ancova_cortical_thickness %>% na.omit() %>% select(c(2,6:73)) %>% 
   dplyr::rename(
    "Left Banks STS" = L_Bankssts_Thck,
    "Left Caudal Anterior Cingulate" = L_Caudalanteriorcingulate_Thck,
    "Left Caudal Middle Frontal" = L_Caudalmiddlefrontal_Thck,
    "Left Cuneus" = L_Cuneus_Thck,
    "Left Entorhinal" = L_Entorhinal_Thck,
    "Left Fusiform" = L_Fusiform_Thck, 
    "Left Inferior Parietal" = L_Inferiorparietal_Thck,
    "Left Inferior Temporal" = L_Inferiortemporal_Thck,
    "Left Isthmuscingulate" = L_Isthmuscingulate_Thck,
    "Left Lateral Occipital" = L_Lateraloccipital_Thck,
    "Left Lateral Orbitofrontal" = L_Lateralorbitofrontal_Thck,
    "Left Lingual"  = L_Lingual_Thck,
    "Left Medialorbitofrontal" = L_Medialorbitofrontal_Thck,
    "Left Middletemporal" = L_Middletemporal_Thck,
    "Left Parahippocampal" = L_Parahippocampal_Thck,
    "Left Paracentral" = L_Paracentral_Thck,
    "Left Parsopercularis" = L_Parsopercularis_Thck,
    "Left Parsorbitalis" = L_Parsorbitalis_Thck,
    "Left Parstriangularis" = L_Parstriangularis_Thck,
    "Left Pericalcarine" = L_Pericalcarine_Thck,
    "Left Postcentral" = L_Postcentral_Thck,
    "Left Posterior Cingulate" = L_Posteriorcingulate_Thck,
    "Left Precentral" = L_Precentral_Thck,
    "Left Precuneus" = L_Precuneus_Thck,
    "Left Rostral anterior cingulate" = L_Rostralanteriorcingulate_Thck,
    "Left Rostral middle frontal" = L_Rostralmiddlefrontal_Thck,
    "Left Superior Frontal" = L_Superiorfrontal_Thck,
    "Left Superior Parietal" = L_Superiorparietal_Thck,
    "Left Superior Temporal" = L_Superiortemporal_Thck,
    "Left Supramarginal" = L_Supramarginal_Thck,
    "Left Frontal Pole" = L_Frontalpole_Thck,
    "Left Temporal Pole" = L_Temporalpole_Thck,
    "Left Transverse Temporal" = L_Transversetemporal_Thck,
    "Left Insula" = L_Insula_Thck,
    "Right Banks STS" = R_Bankssts_Thck,
    "Right Caudal Anterior Cingulate"= R_Caudalanteriorcingulate_Thck,
    "Right Caudal Middle Frontal" = R_Caudalmiddlefrontal_Thck,
    "Right Cuneus" = R_Cuneus_Thck,
    "Right Entorhinal" = R_Entorhinal_Thck,
    "Right Fusiform" = R_Fusiform_Thck,
    "Right Inferior Parietal" =R_Inferiorparietal_Thck,
    "Right Inferior Temporal" = R_Inferiortemporal_Thck,
    "Right Isthmuscingulate" = R_Isthmuscingulate_Thck,
    "Right Lateral Occipital" = R_Lateraloccipital_Thck,
    "Right Lateral Orbitofrontal" = R_Lateralorbitofrontal_Thck,
    "Right Lingual" = R_Lingual_Thck,
    "Right Medial Orbitofrontal" = R_Medialorbitofrontal_Thck,
    "Right Middle Temporal"= R_Middletemporal_Thck,
    "Right _Parahippocampal" = R_Parahippocampal_Thck,
    "Right Paracentral" = R_Paracentral_Thck,
    "Right Parsopercularis"= R_Parsopercularis_Thck,
    "Right Parsorbitalis" = R_Parsorbitalis_Thck,
    "Right Parstriangularis" = R_Parstriangularis_Thck,
    "Right Pericalcarine" = R_Pericalcarine_Thck,
    "Right Postcentral" = R_Postcentral_Thck,
    "Right Posterior Cingulate" = R_Posteriorcingulate_Thck,
    "Right Precentral" = R_Precentral_Thck,
    "Right Precuneus" = R_Precuneus_Thck,
    "Right Rostral Anterior Cingulate" = R_Rostralanteriorcingulate_Thck,
    "Right Rostral Middle Frontal" = R_Rostralmiddlefrontal_Thck,
    "Right Superior Frontal" = R_Superiorfrontal_Thck,
    "Right Superior Parietal" = R_Superiorparietal_Thck,
    "Right Superior Temporal" = R_Superiortemporal_Thck,
    "Right Supramarginal" = R_Supramarginal_Thck,
    "Right Frontal Pole" = R_Frontalpole_Thck,
    "Right Temporal Pole" = R_Temporalpole_Thck,                  
    "Right Transverse Temporal" = R_Transversetemporal_Thck,
    "Right Insula" = R_Insula_Thck ) %>% tbl_summary(by = Racial_identity, statistic = list(all_continuous() ~ "{mean} ({sd})"), digits = all_continuous() ~ function(x) format(x, format = "e", digits = 4)) %>%
    modify_header(label ~ "**Brain Regions**") %>% as_gt()
```


```{r}
set.seed(1234)
permutational_ancova_cortical_thickness_adjage_educ_income <- lapply(permutational_ancova_cortical_thickness[,6:73], function(x) aovp(x ~ permutational_ancova_cortical_thickness$Racial_identity+ permutational_ancova_cortical_thickness$Age_in_Yrs+ permutational_ancova_cortical_thickness$Gender+  permutational_ancova_cortical_thickness$SSAGA_Educ+ permutational_ancova_cortical_thickness$SSAGA_Income))
```

#### Left Banks of superior temporal sulcus
```{r}

summary(permutational_ancova_cortical_thickness_adjage_educ_income$L_Bankssts_Thck)
```

#### Left Caudal Anterior Cingulate Cortex
```{r}

summary(permutational_ancova_cortical_thickness_adjage_educ_income$L_Caudalanteriorcingulate_Thck)
```

#### Left Caudal Middle Frontal Gyrus
```{r}
summary(permutational_ancova_cortical_thickness_adjage_educ_income$L_Caudalmiddlefrontal_Thck)
```

#### Left Cuneus Cortex
```{r}

summary(permutational_ancova_cortical_thickness_adjage_educ_income$L_Cuneus_Thck)
```

#### Left Entorhinal Cortex
```{r}
summary(permutational_ancova_cortical_thickness_adjage_educ_income$L_Entorhinal_Thck)
```

#### Left Fusiform Gyrus
```{r}
summary(permutational_ancova_cortical_thickness_adjage_educ_income$L_Fusiform_Thck)
```

#### Left Inferior Parietal Cortex
```{r}
summary(permutational_ancova_cortical_thickness_adjage_educ_income$L_Inferiorparietal_Thck)
```

#### Left Inferior Temporal Gyrus
```{r}
summary(permutational_ancova_cortical_thickness_adjage_educ_income$L_Inferiortemporal_Thck)
```

#### Left Isthmus of Cingulate Gyrus
```{r}
summary(permutational_ancova_cortical_thickness_adjage_educ_income$L_Isthmuscingulate_Thck)
```

#### Left Lateral Occipital Cortex
```{r}
summary(permutational_ancova_cortical_thickness_adjage_educ_income$L_Lateraloccipital_Thck)
```

#### Left Lateral Orbitofrontal Cortex
```{r}
summary(permutational_ancova_cortical_thickness_adjage_educ_income$L_Lateralorbitofrontal_Thck)
```

#### Left Lingual Gyrus
```{r}
summary(permutational_ancova_cortical_thickness_adjage_educ_income$L_Lingual_Thck)
```

#### Left Medial Orbitofrontal Cortex
```{r}

summary(permutational_ancova_cortical_thickness_adjage_educ_income$L_Medialorbitofrontal_Thck)
```

#### Left Middle Temporal Gyrus
```{r}
summary(permutational_ancova_cortical_thickness_adjage_educ_income$L_Middletemporal_Thck)
```

#### Left Parahippocampal Gyrus
```{r}
summary(permutational_ancova_cortical_thickness_adjage_educ_income$L_Parahippocampal_Thck)
```

#### Left Paracentral Sulcus
```{r}
summary(permutational_ancova_cortical_thickness_adjage_educ_income$L_Paracentral_Thck)
```

#### Left Parsopercularis
```{r}
summary(permutational_ancova_cortical_thickness_adjage_educ_income$L_Parsopercularis_Thck)
```

#### Left Parsorbitalis
```{r}
summary(permutational_ancova_cortical_thickness_adjage_educ_income$L_Parsorbitalis_Thck)
```

#### Left Parstriangularis
```{r}
summary(permutational_ancova_cortical_thickness_adjage_educ_income$L_Parstriangularis_Thck)
```

#### Left Pericalcarine Cortex
```{r}

summary(permutational_ancova_cortical_thickness_adjage_educ_income$L_Pericalcarine_Thck)
```

#### Left Postcentral Gyrus
```{r}
summary(permutational_ancova_cortical_thickness_adjage_educ_income$L_Postcentral_Thck)
```

#### Left Posterior Cingulate Gyrus
```{r}
summary(permutational_ancova_cortical_thickness_adjage_educ_income$L_Posteriorcingulate_Thck)
```

#### Left Precentral Gyrus
```{r}
summary(permutational_ancova_cortical_thickness_adjage_educ_income$L_Precentral_Thck)
```

#### Left Precuneus Cortex
```{r}
summary(permutational_ancova_cortical_thickness_adjage_educ_income$L_Precuneus_Thck)
```

#### Left Rostral Anterior Cingulate Cortex
```{r}
summary(permutational_ancova_cortical_thickness_adjage_educ_income$L_Rostralanteriorcingulate_Thck)
```

#### Left Rostral Middle Frontal Gyrus
```{r}
summary(permutational_ancova_cortical_thickness_adjage_educ_income$L_Rostralmiddlefrontal_Thck)
```

#### Left Superior Frontal Gyrus
```{r}
summary(permutational_ancova_cortical_thickness_adjage_educ_income$L_Superiorfrontal_Thck)
```

#### Left Superior Parietal Cortex
```{r}
summary(permutational_ancova_cortical_thickness_adjage_educ_income$L_Superiorparietal_Thck)
```

#### Left Superior Temporal Gyrus
```{r}
summary(permutational_ancova_cortical_thickness_adjage_educ_income$L_Superiortemporal_Thck)
```

#### Left Supramarginal Gyrus
```{r}
summary(permutational_ancova_cortical_thickness_adjage_educ_income$L_Supramarginal_Thck)
```

#### Left Frontal Pole
```{r}
summary(permutational_ancova_cortical_thickness_adjage_educ_income$L_Frontalpole_Thck)
```

#### Left Temporal Pole
```{r}
summary(permutational_ancova_cortical_thickness_adjage_educ_income$L_Temporalpole_Thck)
```

#### Left Transverse Temporal Cortex
```{r}
summary(permutational_ancova_cortical_thickness_adjage_educ_income$L_Transversetemporal_Thck)
```

#### Left Insula 
```{r}
summary(permutational_ancova_cortical_thickness_adjage_educ_income$L_Insula_Thck)
```

#### Right Banks of superior temporal sulcus
```{r}
summary(permutational_ancova_cortical_thickness_adjage_educ_income$R_Bankssts_Thck)
```

#### Right Caudal Anterior Cingulate Cortex
```{r}
summary(permutational_ancova_cortical_thickness_adjage_educ_income$R_Caudalanteriorcingulate_Thck)
```

#### Right Caudal Middle Frontal Gyrus
```{r}
summary(permutational_ancova_cortical_thickness_adjage_educ_income$R_Caudalmiddlefrontal_Thck)
```

#### Right Cuneus Cortex
```{r}
summary(permutational_ancova_cortical_thickness_adjage_educ_income$R_Cuneus_Thck)
```

#### Right Entorhinal Cortex
```{r}
summary(permutational_ancova_cortical_thickness_adjage_educ_income$R_Entorhinal_Thck)
```

#### Right Fusiform Gyrus
```{r}
summary(permutational_ancova_cortical_thickness_adjage_educ_income$R_Fusiform_Thck)
```

#### Right Inferior Parietal Cortex
```{r}
summary(permutational_ancova_cortical_thickness_adjage_educ_income$R_Inferiorparietal_Thck)
```

#### Right Inferior Temporal Gyrus
```{r}
summary(permutational_ancova_cortical_thickness_adjage_educ_income$R_Inferiortemporal_Thck)
```

#### Right Isthmus of Cingulate Gyrus
```{r}
summary(permutational_ancova_cortical_thickness_adjage_educ_income$R_Isthmuscingulate_Thck)
```

#### Right Lateral Occipital Cortex
```{r}
summary(permutational_ancova_cortical_thickness_adjage_educ_income$R_Lateraloccipital_Thck)
```

#### Right Lateral Orbitofrontal Cortex,
```{r}
summary(permutational_ancova_cortical_thickness_adjage_educ_income$R_Lateralorbitofrontal_Thck)
```

#### Right Lingual Gyrus
```{r}
summary(permutational_ancova_cortical_thickness_adjage_educ_income$R_Lingual_Thck)
```

#### Right Medial Orbitofrontal Cortex
```{r}
summary(permutational_ancova_cortical_thickness_adjage_educ_income$R_Medialorbitofrontal_Thck)
```

#### Right Middle Temporal Gyrus
```{r}
summary(permutational_ancova_cortical_thickness_adjage_educ_income$R_Middletemporal_Thck)
```

#### Right Parahippocampal Gyrus
```{r}
summary(permutational_ancova_cortical_thickness_adjage_educ_income$R_Parahippocampal_Thck)
```

#### Right Paracentral Sulcus
```{r}
summary(permutational_ancova_cortical_thickness_adjage_educ_income$R_Paracentral_Thck)
```

#### Right Parsopercularis
```{r}
summary(permutational_ancova_cortical_thickness_adjage_educ_income$R_Parsopercularis_Thck)
```

#### Right Parsorbitalis
```{r}
summary(permutational_ancova_cortical_thickness_adjage_educ_income$R_Parsorbitalis_Thck)
```

#### Right Parstriangularis 
```{r}
summary(permutational_ancova_cortical_thickness_adjage_educ_income$R_Parstriangularis_Thck)
```

#### Right Pericalcarine Cortex
```{r}
summary(permutational_ancova_cortical_thickness_adjage_educ_income$R_Pericalcarine_Thck)
```

#### Right Postcentral Gyrus
```{r}
summary(permutational_ancova_cortical_thickness_adjage_educ_income$R_Postcentral_Thck)
```

#### Right Posterior Cingulate Gyrus
```{r}
summary(permutational_ancova_cortical_thickness_adjage_educ_income$R_Posteriorcingulate_Thck)
```

#### Right Precentral Gyrus
```{r}
summary(permutational_ancova_cortical_thickness_adjage_educ_income$R_Precentral_Thck)
```

#### Right Precuneus Cortex
```{r}
summary(permutational_ancova_cortical_thickness_adjage_educ_income$R_Precuneus_Thck)
```

#### Right Rostral Anterior Cingulate Cortex
```{r}
summary(permutational_ancova_cortical_thickness_adjage_educ_income$R_Rostralanteriorcingulate_Thck)
```

#### Right Rostral Middle Frontal Gyrus
```{r}
summary(permutational_ancova_cortical_thickness_adjage_educ_income$R_Rostralmiddlefrontal_Thck)
```

#### Right Superior Frontal Gyrus
```{r}
summary(permutational_ancova_cortical_thickness_adjage_educ_income$R_Superiorfrontal_Thck)
```

#### Right Superior Parietal Cortex
```{r}
summary(permutational_ancova_cortical_thickness_adjage_educ_income$R_Superiorparietal_Thck)
```

#### Right Superior Temporal Gyrus
```{r}
summary(permutational_ancova_cortical_thickness_adjage_educ_income$R_Superiortemporal_Thck)
```

#### Right Supramarginal Gyrus
```{r}
summary(permutational_ancova_cortical_thickness_adjage_educ_income$R_Supramarginal_Thck)
```

#### Right Frontal Pole
```{r}
summary(permutational_ancova_cortical_thickness_adjage_educ_income$R_Frontalpole_Thck)
```

#### Right Temporal Pole
```{r}
summary(permutational_ancova_cortical_thickness_adjage_educ_income$R_Temporalpole_Thck)
```

#### Right Transverse Temporal Cortex
```{r}
summary(permutational_ancova_cortical_thickness_adjage_educ_income$R_Transversetemporal_Thck)
```

#### Right Insula 
```{r}
summary(permutational_ancova_cortical_thickness_adjage_educ_income$R_Insula_Thck)
```


## Multiple comparisons correction Holm-Bonferroni method

```{r}
## Extraction of p-values of the permutational analysis (permutational_ancova_cortical_thickness_adjage_educ_income[,c("columns with cortical thickness data")]

set.seed(1234)
pvalues_modpermut_cortical_thikness_adjage_gender_educ_income <- sapply(permutational_ancova_cortical_thickness[,6:73], function(x) aovp(x ~ permutational_ancova_cortical_thickness$Racial_identity+ permutational_ancova_cortical_thickness$Age_in_Yrs+ permutational_ancova_cortical_thickness$Gender+  permutational_ancova_cortical_thickness$SSAGA_Educ+ permutational_ancova_cortical_thickness$SSAGA_Income)$perm$P)

## Conversion of p-values in a data frame format

pvalues_permutation_multiple_comparisons_cortical_thickness <- as.data.frame(pvalues_modpermut_cortical_thikness_adjage_gender_educ_income) %>% slice(2)

pvalues_permutation_multiple_comparisons_cortical_thickness <-pvalues_permutation_multiple_comparisons_cortical_thickness %>%  gather(key = "cortical_thickness", value = "permutation_pvalue") 

## Execution of Holm-Bonferroni multiple comparison analysis 

pvalues_permutation_multiple_comparisons_cortical_thickness$Holm =p.adjust(pvalues_permutation_multiple_comparisons_cortical_thickness$permutation_pvalue,method ="holm")
```


```{r echo=FALSE}
knitr::kable(pvalues_permutation_multiple_comparisons_cortical_thickness, format = "simple", align = "c", col.names = c('Brain cortical regions', 'permutation p-values', 'Holm'))

pvalues_permutation_multiple_comparisons_cortical_thickness %>% filter(Holm < 0.05)

```


### Graphs of brain cortical thickness with statistical significance after multiple comparisons analysis


```{r echo=FALSE, fig.width=10}
data_cortical_thickness_plotted <- permutational_ancova_cortical_thickness %>% na.omit() %>% dplyr::select(c(2,11,40,44,46,43,53,64,60,69,72,9,15,49,17,51,25,26))  %>% dplyr::rename(
    "Right Banks STS***"= R_Bankssts_Thck,
    "Right Entorhinal***"= R_Entorhinal_Thck,
    "Right Middle Temporal***"= R_Middletemporal_Thck,
    "Right Transverse Temporal***"= R_Transversetemporal_Thck,   
     "Right Inferior Parietal***"= R_Inferiorparietal_Thck,
   "Left Cuneus***"= L_Cuneus_Thck,
   "Right Cuneus***"= R_Cuneus_Thck,
   "Left Fusiform***" = L_Fusiform_Thck, 
    "Left Lateral Occipital***"= L_Lateraloccipital_Thck,
    "Right Lateral Occipital***"= R_Lateraloccipital_Thck,
    "Left Lingual***"= L_Lingual_Thck,
    "Right Lingual***"= R_Lingual_Thck,
    "Left Pericalcarine***"= L_Pericalcarine_Thck,
    "Left Postcentral***"= L_Postcentral_Thck,
   "Right Postcentral***"= R_Postcentral_Thck,
   "Right Rostral-Anterior Cingulate*"= R_Rostralanteriorcingulate_Thck,
    "Right Supramarginal***"  = R_Supramarginal_Thck
) %>% gather(key = "thickness", value = "milimeters", -Racial_identity)



plot_cortical_thickness_permutation_facet <- ggplot(data = data_cortical_thickness_plotted, aes(y = milimeters , x = thickness, fill = Racial_identity)) + 
geom_half_violin((aes(fill = factor(Racial_identity))),position = position_nudge(x = .6, y = 0), alpha = .8) +
 geom_boxplot(aes(y = milimeters , x = thickness,fill=Racial_identity), position = position_dodge(.5), notch = TRUE,outlier.shape = NA, width= 0.3, alpha =0.4, show.legend = FALSE) +  stat_summary(aes(y = milimeters , x = thickness,fill=Racial_identity),fun.y="mean",position = position_dodge(.5), show.legend = FALSE) +  geom_point((aes(colour = factor(Racial_identity))), position = position_jitterdodge(dodge.width = 0.55), size = .5, alpha = .8, show.legend = FALSE) + 
  #coord_cartesian(ylim=c(0,0.001)) + 
  facet_wrap(~thickness, scales = "free") +
#expand_limits(x = 6) +
#guides(fill = TRUE) +
#guides(color = TRUE) +
#scale_color_manual(values=c("red", "blue")) +
scale_fill_discrete(labels = c("Whites", "African Americans")) +
#scale_color_brewer(palette = "Spectral") +
#scale_fill_brewer(palette = "Spectral") +
#coord_flip() +
theme_light(base_size = 12, base_family = "Arial") +
  #ggtitle("Cortical Thickness Results") +
  xlab("") + ylab("Thickness (mm)") + labs(fill = "") + labs(col = "")  + theme(legend.position = "top",axis.text.x=element_blank(), strip.text.x = element_text(color = "black", face = "bold"))  #+ geom_signif(comparisons = list(c("White", "Black or African Am.")),tip_length=0,y_position = 9, textsize = 4)

plot_cortical_thickness_permutation_facet

```

# 3. Brain surface brain area ANCOVA permutational analysis

#### Permutational analysis adjusted for Age, Gender, Education (years) & Economic income


```{r include=FALSE}
permutational_ancova_surface_area <- data_connectome_filtered_with_volumetry_normalized_icv %>% dplyr::select(c(2,10,14,15,205,524:591))  %>% dplyr::rename(
    L_Bankssts_Area = FS_L_Bankssts_Area,
    L_Caudalanteriorcingulate_Area = FS_L_Caudalanteriorcingulate_Area,
    L_Caudalmiddlefrontal_Area = FS_L_Caudalmiddlefrontal_Area,
    L_Cuneus_Area = FS_L_Cuneus_Area,
    L_Entorhinal_Area = FS_L_Entorhinal_Area,
    L_Fusiform_Area = FS_L_Fusiform_Area, 
    L_Inferiorparietal_Area = FS_L_Inferiorparietal_Area, 
    L_Inferiortemporal_Area = FS_L_Inferiortemporal_Area, 
    L_Isthmuscingulate_Area = FS_L_Isthmuscingulate_Area,
    L_Lateraloccipital_Area = FS_L_Lateraloccipital_Area,
    L_Lateralorbitofrontal_Area = FS_L_Lateralorbitofrontal_Area,
    L_Lingual_Area = FS_L_Lingual_Area,
    L_Medialorbitofrontal_Area = FS_L_Medialorbitofrontal_Area,
    L_Middletemporal_Area = FS_L_Middletemporal_Area,
    L_Parahippocampal_Area = FS_L_Parahippocampal_Area,
    L_Paracentral_Area = FS_L_Paracentral_Area,
    L_Parsopercularis_Area = FS_L_Parsopercularis_Area,
    L_Parsorbitalis_Area = FS_L_Parsorbitalis_Area,
    L_Parstriangularis_Area = FS_L_Parstriangularis_Area,
    L_Pericalcarine_Area = FS_L_Pericalcarine_Area,
    L_Postcentral_Area = FS_L_Postcentral_Area,
    L_Posteriorcingulate_Area = FS_L_Posteriorcingulate_Area,
    L_Precentral_Area = FS_L_Precentral_Area,
    L_Precuneus_Area = FS_L_Precuneus_Area,
    L_Rostralanteriorcingulate_Area = FS_L_Rostralanteriorcingulate_Area,
    L_Rostralmiddlefrontal_Area = FS_L_Rostralmiddlefrontal_Area,
    L_Superiorfrontal_Area = FS_L_Superiorfrontal_Area,
    L_Superiorparietal_Area = FS_L_Superiorparietal_Area,
    L_Superiortemporal_Area = FS_L_Superiortemporal_Area,
    L_Supramarginal_Area = FS_L_Supramarginal_Area,
    L_Frontalpole_Area = FS_L_Frontalpole_Area,
    L_Temporalpole_Area = FS_L_Temporalpole_Area,
    L_Transversetemporal_Area = FS_L_Transversetemporal_Area,
    L_Insula_Area = FS_L_Insula_Area,
    R_Bankssts_Area = FS_R_Bankssts_Area,
    R_Caudalanteriorcingulate_Area = FS_R_Caudalanteriorcingulate_Area,
    R_Caudalmiddlefrontal_Area = FS_R_Caudalmiddlefrontal_Area,
    R_Cuneus_Area = FS_R_Cuneus_Area,
    R_Entorhinal_Area = FS_R_Entorhinal_Area,
    R_Fusiform_Area= FS_R_Fusiform_Area,
    R_Inferiorparietal_Area = FS_R_Inferiorparietal_Area,
    R_Inferiortemporal_Area = FS_R_Inferiortemporal_Area,
    R_Isthmuscingulate_Area = FS_R_Isthmuscingulate_Area,
    R_Lateraloccipital_Area = FS_R_Lateraloccipital_Area,
    R_Lateralorbitofrontal_Area = FS_R_Lateralorbitofrontal_Area,
    R_Lingual_Area = FS_R_Lingual_Area,
    R_Medialorbitofrontal_Area = FS_R_Medialorbitofrontal_Area,
    R_Middletemporal_Area = FS_R_Middletemporal_Area,
    R_Parahippocampal_Area = FS_R_Parahippocampal_Area,
    R_Paracentral_Area = FS_R_Paracentral_Area,
    R_Parsopercularis_Area = FS_R_Parsopercularis_Area,
    R_Parsorbitalis_Area = FS_R_Parsorbitalis_Area,
    R_Parstriangularis_Area = FS_R_Parstriangularis_Area,
    R_Pericalcarine_Area = FS_R_Pericalcarine_Area,
    R_Postcentral_Area = FS_R_Postcentral_Area,
    R_Posteriorcingulate_Area = FS_R_Posteriorcingulate_Area,
    R_Precentral_Area = FS_R_Precentral_Area,
    R_Precuneus_Area = FS_R_Precuneus_Area,
    R_Rostralanteriorcingulate_Area = FS_R_Rostralanteriorcingulate_Area,
    R_Rostralmiddlefrontal_Area = FS_R_Rostralmiddlefrontal_Area,
    R_Superiorfrontal_Area = FS_R_Superiorfrontal_Area,
    R_Superiorparietal_Area = FS_R_Superiorparietal_Area,
    R_Superiortemporal_Area = FS_R_Superiortemporal_Area, 
    R_Supramarginal_Area = FS_R_Supramarginal_Area,
    R_Frontalpole_Area = FS_R_Frontalpole_Area,
    R_Temporalpole_Area = FS_R_Temporalpole_Area,
    R_Transversetemporal_Area = FS_R_Transversetemporal_Area,            
    R_Insula_Area = FS_R_Insula_Area)
```

#### Brain Cortical Surface Area descriptives

```{r}
permutational_ancova_surface_area %>% na.omit() %>% select(c(2,6:73)) %>% 
   dplyr::rename(
    "Left Banks STS" = L_Bankssts_Area,
    "Left Caudal Anterior Cingulate" = L_Caudalanteriorcingulate_Area,
    "Left Caudal Middle Frontal" = L_Caudalmiddlefrontal_Area,
    "Left Cuneus" = L_Cuneus_Area,
    "Left Entorhinal" = L_Entorhinal_Area,
    "Left Fusiform" = L_Fusiform_Area, 
    "Left Inferior Parietal" = L_Inferiorparietal_Area,
    "Left Inferior Temporal" = L_Inferiortemporal_Area,
    "Left Isthmuscingulate" = L_Isthmuscingulate_Area,
    "Left Lateral Occipital" = L_Lateraloccipital_Area,
    "Left Lateral Orbitofrontal" = L_Lateralorbitofrontal_Area,
    "Left Lingual"  = L_Lingual_Area,
    "Left Medialorbitofrontal" = L_Medialorbitofrontal_Area,
    "Left Middletemporal" = L_Middletemporal_Area,
    "Left Parahippocampal" = L_Parahippocampal_Area,
    "Left Paracentral" = L_Paracentral_Area,
    "Left Parsopercularis" = L_Parsopercularis_Area,
    "Left Parsorbitalis" = L_Parsorbitalis_Area,
    "Left Parstriangularis" = L_Parstriangularis_Area,
    "Left Pericalcarine" = L_Pericalcarine_Area,
    "Left Postcentral" = L_Postcentral_Area,
    "Left Posterior Cingulate" = L_Posteriorcingulate_Area,
    "Left Precentral" = L_Precentral_Area,
    "Left Precuneus" = L_Precuneus_Area,
    "Left Rostral anterior cingulate" = L_Rostralanteriorcingulate_Area,
    "Left Rostral middle frontal" = L_Rostralmiddlefrontal_Area,
    "Left Superior Frontal" = L_Superiorfrontal_Area,
    "Left Superior Parietal" = L_Superiorparietal_Area,
    "Left Superior Temporal" = L_Superiortemporal_Area,
    "Left Supramarginal" = L_Supramarginal_Area,
    "Left Frontal Pole" = L_Frontalpole_Area,
    "Left Temporal Pole" = L_Temporalpole_Area,
    "Left Transverse Temporal" = L_Transversetemporal_Area,
    "Left Insula" = L_Insula_Area,
    "Right Banks STS" = R_Bankssts_Area,
    "Right Caudal Anterior Cingulate"= R_Caudalanteriorcingulate_Area,
    "Right Caudal Middle Frontal" = R_Caudalmiddlefrontal_Area,
    "Right Cuneus" = R_Cuneus_Area,
    "Right Entorhinal" = R_Entorhinal_Area,
    "Right Fusiform" = R_Fusiform_Area,
    "Right Inferior Parietal" =R_Inferiorparietal_Area,
    "Right Inferior Temporal" = R_Inferiortemporal_Area,
    "Right Isthmuscingulate" = R_Isthmuscingulate_Area,
    "Right Lateral Occipital" = R_Lateraloccipital_Area,
    "Right Lateral Orbitofrontal" = R_Lateralorbitofrontal_Area,
    "Right Lingual" = R_Lingual_Area,
    "Right Medial Orbitofrontal" = R_Medialorbitofrontal_Area,
    "Right Middle Temporal"= R_Middletemporal_Area,
    "Right Parahippocampal" = R_Parahippocampal_Area,
    "Right Paracentral" = R_Paracentral_Area,
    "Right Parsopercularis"= R_Parsopercularis_Area,
    "Right Parsorbitalis" = R_Parsorbitalis_Area,
    "Right Parstriangularis" = R_Parstriangularis_Area,
    "Right Pericalcarine" = R_Pericalcarine_Area,
    "Right Postcentral" = R_Postcentral_Area,
    "Right Posterior Cingulate" = R_Posteriorcingulate_Area,
    "Right Precentral" = R_Precentral_Area,
    "Right Precuneus" = R_Precuneus_Area,
    "Right Rostral Anterior Cingulate" = R_Rostralanteriorcingulate_Area,
    "Right Rostral Middle Frontal" = R_Rostralmiddlefrontal_Area,
    "Right Superior Frontal" = R_Superiorfrontal_Area,
    "Right Superior Parietal" = R_Superiorparietal_Area,
    "Right Superior Temporal" = R_Superiortemporal_Area,
    "Right Supramarginal" = R_Supramarginal_Area,
    "Right Frontal Pole" = R_Frontalpole_Area,
    "Right Temporal Pole" = R_Temporalpole_Area,                  
    "Right Transverse Temporal" = R_Transversetemporal_Area,
    "Right Insula" = R_Insula_Area ) %>% tbl_summary(by = Racial_identity, statistic = list(all_continuous() ~ "{mean} ({sd})"), digits = all_continuous() ~ function(x) format(x, format = "e", digits = 6)) %>%
    modify_header(label ~ "**Brain Regions**") %>% as_gt()
```

```{r}
set.seed(1234)
permutational_ancova_surface_area_adjage_educ_income <- lapply(permutational_ancova_surface_area[,6:73], function(x) aovp(x ~ permutational_ancova_surface_area$Racial_identity+ permutational_ancova_surface_area$Age_in_Yrs+ permutational_ancova_surface_area$Gender+  permutational_ancova_surface_area$SSAGA_Educ+ permutational_ancova_surface_area$SSAGA_Income))
```

#### Left Banks of superior temporal sulcus
```{r}

summary(permutational_ancova_surface_area_adjage_educ_income $L_Bankssts_Area)
```

#### Left Caudal Anterior Cingulate Cortex
```{r}

summary(permutational_ancova_surface_area_adjage_educ_income $L_Caudalanteriorcingulate_Area)
```

#### Left Caudal Middle Frontal Gyrus
```{r}
summary(permutational_ancova_surface_area_adjage_educ_income $L_Caudalmiddlefrontal_Area)
```

#### Left Cuneus Cortex
```{r}

summary(permutational_ancova_surface_area_adjage_educ_income$L_Cuneus_Area)
```

#### Left Entorhinal Cortex
```{r}
summary(permutational_ancova_surface_area_adjage_educ_income$L_Entorhinal_Area)
```

#### Left Fusiform Gyrus
```{r}
summary(permutational_ancova_surface_area_adjage_educ_income$L_Fusiform_Area)
```

#### Left Inferior Parietal Cortex
```{r}
summary(permutational_ancova_surface_area_adjage_educ_income$L_Inferiorparietal_Area)
```

#### Left Inferior Temporal Gyrus
```{r}
summary(permutational_ancova_surface_area_adjage_educ_income$L_Inferiortemporal_Area)
```

#### Left Isthmus of Cingulate Gyrus
```{r}
summary(permutational_ancova_surface_area_adjage_educ_income$L_Isthmuscingulate_Area)
```

#### Left Lateral Occipital Cortex
```{r}
summary(permutational_ancova_surface_area_adjage_educ_income$L_Lateraloccipital_Area)
```

#### Left Lateral Orbitofrontal Cortex
```{r}
summary(permutational_ancova_surface_area_adjage_educ_income$L_Lateralorbitofrontal_Area)
```

#### Left Lingual Gyrus
```{r}
summary(permutational_ancova_surface_area_adjage_educ_income$L_Lingual_Area)
```

#### Left Medial Orbitofrontal Cortex
```{r}

summary(permutational_ancova_surface_area_adjage_educ_income$L_Medialorbitofrontal_Area)
```

#### Left Middle Temporal Gyrus
```{r}
summary(permutational_ancova_surface_area_adjage_educ_income$L_Middletemporal_Area)
```

#### Left Parahippocampal Gyrus
```{r}
summary(permutational_ancova_surface_area_adjage_educ_income$L_Parahippocampal_Area)
```

#### Left Paracentral Sulcus
```{r}
summary(permutational_ancova_surface_area_adjage_educ_income$L_Paracentral_Area)
```

#### Left Parsopercularis
```{r}
summary(permutational_ancova_surface_area_adjage_educ_income$L_Parsopercularis_Area)
```

#### Left Parsorbitalis
```{r}
summary(permutational_ancova_surface_area_adjage_educ_income$L_Parsorbitalis_Area)
```

#### Left Parstriangularis
```{r}
summary(permutational_ancova_surface_area_adjage_educ_income$L_Parstriangularis_Area)
```

#### Left Pericalcarine Cortex
```{r}

summary(permutational_ancova_surface_area_adjage_educ_income$L_Pericalcarine_Area)
```

#### Left Postcentral Gyrus
```{r}
summary(permutational_ancova_surface_area_adjage_educ_income$L_Postcentral_Area)
```

#### Left Posterior Cingulate Gyrus
```{r}
summary(permutational_ancova_surface_area_adjage_educ_income$L_Posteriorcingulate_Area)
```

#### Left Precentral Gyrus
```{r}
summary(permutational_ancova_surface_area_adjage_educ_income$L_Precentral_Area)
```

#### Left Precuneus Cortex
```{r}
summary(permutational_ancova_surface_area_adjage_educ_income$L_Precuneus_Area)
```

#### Left Rostral Anterior Cingulate Cortex
```{r}
summary(permutational_ancova_surface_area_adjage_educ_income$L_Rostralanteriorcingulate_Area)
```

#### Left Rostral Middle Frontal Gyrus
```{r}
summary(permutational_ancova_surface_area_adjage_educ_income$L_Rostralmiddlefrontal_Area)
```

#### Left Superior Frontal Gyrus
```{r}
summary(permutational_ancova_surface_area_adjage_educ_income$L_Superiorfrontal_Area)
```

#### Left Superior Parietal Cortex
```{r}
summary(permutational_ancova_surface_area_adjage_educ_income$L_Superiorparietal_Area)
```

#### Left Superior Temporal Gyrus
```{r}
summary(permutational_ancova_surface_area_adjage_educ_income$L_Superiortemporal_Area)
```

#### Left Supramarginal Gyrus
```{r}
summary(permutational_ancova_surface_area_adjage_educ_income$L_Supramarginal_Area)
```

#### Left Frontal Pole
```{r}
summary(permutational_ancova_surface_area_adjage_educ_income$L_Frontalpole_Area)
```

#### Left Temporal Pole
```{r}
summary(permutational_ancova_surface_area_adjage_educ_income$L_Temporalpole_Area)
```

#### Left Transverse Temporal Cortex
```{r}
summary(permutational_ancova_surface_area_adjage_educ_income$L_Transversetemporal_Area)
```

#### Left Insula 
```{r}
summary(permutational_ancova_surface_area_adjage_educ_income$L_Insula_Area)
```

#### Right Banks of superior temporal sulcus
```{r}
summary(permutational_ancova_surface_area_adjage_educ_income$R_Bankssts_Area)
```

#### Right Caudal Anterior Cingulate Cortex
```{r}
summary(permutational_ancova_surface_area_adjage_educ_income$R_Caudalanteriorcingulate_Area)
```

#### Right Caudal Middle Frontal Gyrus
```{r}
summary(permutational_ancova_surface_area_adjage_educ_income$R_Caudalmiddlefrontal_Area)
```

#### Right Cuneus Cortex
```{r}
summary(permutational_ancova_surface_area_adjage_educ_income$R_Cuneus_Area)
```

#### Right Entorhinal Cortex
```{r}
summary(permutational_ancova_surface_area_adjage_educ_income$R_Entorhinal_Area)
```

#### Right Fusiform Gyrus
```{r}
summary(permutational_ancova_surface_area_adjage_educ_income$R_Fusiform_Area)
```

#### Right Inferior Parietal Cortex
```{r}
summary(permutational_ancova_surface_area_adjage_educ_income$R_Inferiorparietal_Area)
```

#### Right Inferior Temporal Gyrus
```{r}
summary(permutational_ancova_surface_area_adjage_educ_income$R_Inferiortemporal_Area)
```

#### Right Isthmus of Cingulate Gyrus
```{r}
summary(permutational_ancova_surface_area_adjage_educ_income$R_Isthmuscingulate_Area)
```

#### Right Lateral Occipital Cortex
```{r}
summary(permutational_ancova_surface_area_adjage_educ_income$R_Lateraloccipital_Area)
```

#### Right Lateral Orbitofrontal Cortex,
```{r}
summary(permutational_ancova_surface_area_adjage_educ_income$R_Lateralorbitofrontal_Area)
```

#### Right Lingual Gyrus
```{r}
summary(permutational_ancova_surface_area_adjage_educ_income$R_Lingual_Area)
```

#### Right Medial Orbitofrontal Cortex
```{r}
summary(permutational_ancova_surface_area_adjage_educ_income$R_Medialorbitofrontal_Area)
```

#### Right Middle Temporal Gyrus
```{r}
summary(permutational_ancova_surface_area_adjage_educ_income$R_Middletemporal_Area)
```

#### Right Parahippocampal Gyrus
```{r}
summary(permutational_ancova_surface_area_adjage_educ_income$R_Parahippocampal_Area)
```

#### Right Paracentral Sulcus
```{r}
summary(permutational_ancova_surface_area_adjage_educ_income$R_Paracentral_Area)
```

#### Right Parsopercularis
```{r}
summary(permutational_ancova_surface_area_adjage_educ_income$R_Parsopercularis_Area)
```

#### Right Parsorbitalis
```{r}
summary(permutational_ancova_surface_area_adjage_educ_income$R_Parsorbitalis_Area)
```

#### Right Parstriangularis 
```{r}
summary(permutational_ancova_surface_area_adjage_educ_income$R_Parstriangularis_Area)
```

#### Right Pericalcarine Cortex
```{r}
summary(permutational_ancova_surface_area_adjage_educ_income$R_Pericalcarine_Area)
```

#### Right Postcentral Gyrus
```{r}
summary(permutational_ancova_surface_area_adjage_educ_income$R_Postcentral_Area)
```

#### Right Posterior Cingulate Gyrus
```{r}
summary(permutational_ancova_surface_area_adjage_educ_income$R_Posteriorcingulate_Area)
```

#### Right Precentral Gyrus
```{r}
summary(permutational_ancova_surface_area_adjage_educ_income$R_Precentral_Area)
```

#### Right Precuneus Cortex
```{r}
summary(permutational_ancova_surface_area_adjage_educ_income$R_Precuneus_Area)
```

#### Right Rostral Anterior Cingulate Cortex
```{r}
summary(permutational_ancova_surface_area_adjage_educ_income$R_Rostralanteriorcingulate_Area)
```

#### Right Rostral Middle Frontal Gyrus
```{r}
summary(permutational_ancova_surface_area_adjage_educ_income$R_Rostralmiddlefrontal_Area)
```

#### Right Superior Frontal Gyrus
```{r}
summary(permutational_ancova_surface_area_adjage_educ_income$R_Superiorfrontal_Area)
```

#### Right Superior Parietal Cortex
```{r}
summary(permutational_ancova_surface_area_adjage_educ_income$R_Superiorparietal_Area)
```

#### Right Superior Temporal Gyrus
```{r}
summary(permutational_ancova_surface_area_adjage_educ_income$R_Superiortemporal_Area)
```

#### Right Supramarginal Gyrus
```{r}
summary(permutational_ancova_surface_area_adjage_educ_income$R_Supramarginal_Area)
```

#### Right Frontal Pole
```{r}
summary(permutational_ancova_surface_area_adjage_educ_income$R_Frontalpole_Area)
```

#### Right Temporal Pole
```{r}
summary(permutational_ancova_surface_area_adjage_educ_income$R_Temporalpole_Area)
```

#### Right Transverse Temporal Cortex
```{r}
summary(permutational_ancova_surface_area_adjage_educ_income$R_Transversetemporal_Area)
```

#### Right Insula 
```{r}
summary(permutational_ancova_surface_area_adjage_educ_income$R_Insula_Area)
```


## Multiple comparisons correction Holm-Bonferroni method

```{r}
## Extraction of p-values of the permutational analysis (permutational_ancova_surface_area_adjage_educ_income[,c("columns with surface area data")]

set.seed(1234)
pvalues_modpermut_surface_area_adjage_gender_educ_income <- sapply(permutational_ancova_surface_area[,6:73], function(x) aovp(x ~ permutational_ancova_surface_area$Racial_identity+ permutational_ancova_surface_area$Age_in_Yrs+ permutational_ancova_surface_area$Gender+  permutational_ancova_surface_area$SSAGA_Educ+ permutational_ancova_surface_area$SSAGA_Income)$perm$P)

## Conversion of p-values in a data frame format

pvalues_permutation_multiple_comparisons_surface_area <- as.data.frame(pvalues_modpermut_surface_area_adjage_gender_educ_income) %>% slice(2)

pvalues_permutation_multiple_comparisons_surface_area <-pvalues_permutation_multiple_comparisons_surface_area%>%  gather(key = "surface_area", value = "permutation_pvalue") 

## Execution of Holm-Bonferroni multiple comparison analysis 

pvalues_permutation_multiple_comparisons_surface_area$Holm =p.adjust(pvalues_permutation_multiple_comparisons_surface_area$permutation_pvalue,method ="holm")
```

```{r echo=FALSE}
knitr::kable(pvalues_permutation_multiple_comparisons_surface_area, format = "simple", align = "c", col.names = c('Brain surface regions', 'permutation p-values', 'Holm'))

pvalues_permutation_multiple_comparisons_surface_area %>%  filter(Holm <0.05)
```

### Graphs of brain surface area with statistical significance after multiple comparisons analysis


```{r echo=FALSE, fig.width=15, fig.height=10}
data_surface_area_plotted <- permutational_ancova_surface_area %>% na.omit() %>% 
dplyr::select(c(2,10,45,13,15,49,17,63,57,32,33,67,42,16,22,56,70,66))  %>% dplyr::rename(
    "Left Entorhinal***"= L_Entorhinal_Area,
    "Right Fusiform*" = R_Fusiform_Area,
    "Left Inferior Temporal***" = L_Inferiortemporal_Area,
    #"Right Inferior Temporal***" = R_Inferiortemporal_Area,
    #"Left Middle Temporal***"= L_Middletemporal_Area,
    #"Right Middle Temporal***"= R_Middletemporal_Area,
    #"Left Cuneus***"= L_Cuneus_Area,
    #"Right Cuneus***"= R_Cuneus_Area,
    "Left Lateral Occipital***"= L_Lateraloccipital_Area,
    "Right Lateral Occipital***"= R_Lateraloccipital_Area,
    "Left Lingual***"= L_Lingual_Area,
    #"Left Pericalcarine***"= L_Pericalcarine_Area,
    #"Left Precuneus***"= L_Precuneus_Area,
    "Right Precuneus***"= R_Precuneus_Area,
    "Right Superior Parietal***"= R_Superiorparietal_Area,
    "Right Caudal Middle Frontal***"= R_Caudalmiddlefrontal_Area,
    "Right Frontal Pole***"= R_Frontalpole_Area,
   "Left Lateral Orbitofrontal***"= L_Lateralorbitofrontal_Area,
  "Left Parsopercularis***"=  L_Parsopercularis_Area,
  "Right Parsopercularis***"=  R_Parsopercularis_Area,
   "Right Parsorbitalis***"=  R_Parsorbitalis_Area,
  "Right Superior Frontal***"=R_Superiorfrontal_Area,
  "Left Superior Frontal***"= L_Superiorfrontal_Area,
   "Left Superior Parietal***" =L_Superiorparietal_Area
) %>% gather(key = "surface_area", value = "square_milimeters", -Racial_identity)

plot_wrap_all_regions_surface_area <- ggplot(data = data_surface_area_plotted, aes(y = square_milimeters , x = surface_area, fill = Racial_identity)) + 
geom_half_violin((aes(fill = factor(Racial_identity))),position = position_nudge(x = .6, y = 0), alpha = .8) + geom_boxplot(aes(y = square_milimeters , x = surface_area,fill=Racial_identity), position = position_dodge(.5), notch = TRUE,outlier.shape = NA, width= 0.3, alpha =0.4, show.legend = FALSE) +  stat_summary(aes(y = square_milimeters , x = surface_area,fill=Racial_identity),fun.y="mean",position = position_dodge(.5), show.legend = FALSE) +  geom_point((aes(colour = factor(Racial_identity))), position = position_jitterdodge(dodge.width = 0.55), size = .5, alpha = .8, show.legend = FALSE) + 
  facet_wrap(~surface_area, scales = "free") +
scale_fill_discrete(labels = c("Whites", "African Americans")) +
theme_light(base_size = 12, base_family = "Arial") +
  xlab("") + ylab(expression("Surface area"~"("*mm^2*")")) + labs(fill = "") + labs(col = "")  + theme(legend.position = "top",axis.text.x=element_blank(), strip.text.x = element_text(color = "black", face = "bold")) 

plot_wrap_all_regions_surface_area

```

# 4. HCP sample paired 

### The sample was selected aiming to pair Whites and African American identities by age, education, economic income and gender. 

```{r include=FALSE}
data_connectomehcp_filtered_paired <- read_csv("data_connectomehcp_filtered_paired.csv")
```

```{r}
### Factorized GENDER, RACIAL IDENTITY, and ECONOMIC INCOME variables

data_connectomehcp_filtered_paired$Racial_identity <- factor(data_connectomehcp_filtered_paired$Racial_identity, levels = c("White","Black or African Am."),labels = c("0","1"))

data_connectomehcp_filtered_paired$Gender <-factor(data_connectomehcp_filtered_paired$Gender, levels = c("M","F"),labels = c("0","1"))

data_connectomehcp_filtered_paired$Gender <-factor(data_connectomehcp_filtered_paired$Gender, levels = c("0","1"),labels = c("M","F"))

data_connectomehcp_filtered_paired$Racial_identity <- factor(data_connectomehcp_filtered_paired$Racial_identity, levels = c("0","1"),labels = c("White","Black or African Am."))


```

```{r}
data_connectomehcp_filtered_paired_table_descriptives <- data_connectomehcp_filtered_paired %>% select(Age_in_Yrs,Racial_identity,SSAGA_Educ,Gender,SSAGA_Income) %>% tbl_summary(by = Racial_identity, label = list( Age_in_Yrs ~ "Age (y)", SSAGA_Educ ~ "Education(y)", Gender ~ "Sex", SSAGA_Income ~ "Economic Income "), type = list(SSAGA_Educ ~ 'continuous'), statistic = c("Age_in_Yrs", "SSAGA_Educ") ~ "{mean} ({sd})", digits = all_continuous() ~ 2) %>% add_p(pvalue_fun = ~style_pvalue(.x, digits = 3), list(all_continuous() ~ "t.test")) %>%  add_n() %>%     modify_caption("**Table 1. Descriptives for racial identity**") %>% modify_header(label ~ "")  %>%  bold_labels() %>% modify_spanning_header(all_stat_cols() ~ "**Racial Identity**") %>% as_gt()%>% opt_align_table_header(align = "left") 

data_connectomehcp_filtered_paired_table_descriptives

```

# 5. Brain volume analysis of paired sample t-test

```{r}
## Selection of brain volumetric and Racial identity variables


data_connectomehcp_filtered_paired_volumetry <- data_connectomehcp_filtered_paired %>% select(c(2,142:153,160:198))


## Welch t-test analysis with non-homogeneous of variance assumption

data_connectomehcp_filtered_paired_volumetry_welcht_test  <- lapply(data_connectomehcp_filtered_paired_volumetry[c(2:52)], function(x) t.test(x ~ data_connectomehcp_filtered_paired_volumetry$Racial_identity, var.equal = FALSE))

data_connectomehcp_filtered_paired_volumetry_welcht_test 

```



##  Multiple comparisons correction Holm-Bonferroni method

```{r echo=TRUE}


# p-values Welch t-test analysis with non-homogeneous of variance assumption

pvalues_data_connectomehcp_filtered_paired_volumetry_welch_t_test <- sapply(data_connectomehcp_filtered_paired_volumetry[c(2:52)], function(x) t.test(x ~ data_connectomehcp_filtered_paired_volumetry$Racial_identity, var.equal = FALSE)$p.value)

pvalues_data_connectomehcp_filtered_paired_volumetry_welch_t_test <- as.data.frame(pvalues_data_connectomehcp_filtered_paired_volumetry_welch_t_test) %>% dplyr::rename(pvalue=pvalues_data_connectomehcp_filtered_paired_volumetry_welch_t_test) %>% dplyr::select(1)


## Execution of Holm-Bonferroni multiple comparison analysis 

pvalues_data_connectomehcp_filtered_paired_volumetry_welch_t_test$Holm =p.adjust(pvalues_data_connectomehcp_filtered_paired_volumetry_welch_t_test$pvalue,method ="holm") 

```


```{r echo=FALSE}
knitr::kable(pvalues_data_connectomehcp_filtered_paired_volumetry_welch_t_test, format = "simple", align = "c", col.names = c('p-values', 'Holm'))


pvalues_data_connectomehcp_filtered_paired_volumetry_welch_t_test %>% filter (Holm < 0.05)
```

### Table statistical summary of brain volumetry 

```{r}
data_connectomehcp_filtered_paired_volumetry %>% 
dplyr::rename(
    "Brain Seg"= BrainSeg_Vol,                         
    "Brain Seg No Vent" = BrainSeg_Vol_No_Vent,                  
    "Brain Seg No Vent Surf" = BrainSeg_Vol_No_Vent_Surf,
    "Left Cortical GM" = Lcort_GM_Vol,                         
    "Right Cortical GM" =Rcort_GM_Vol,
    "Cortical GM" = TotCort_GM_Vol, 
    "Subcortical GM" = SubCort_GM_Vol,
    "Total GM" = Total_GM_Vol,
    "SupraTentorial" = SupraTentorial_Vol,
    "Left WM" = L_WM_Vol,
    "Right WM" = R_WM_Vol,
    "Total WM" = Tot_WM_Vol,
    "Left Lat Ventricle" = L_LatVent_Vol,
    "Left Inf Lat Ventricle" = L_InfLatVent_Vol,
    "Left Cerebellum WM" = L_Cerebellum_WM_Vol,
    "Left Cerebellum Cortex" = L_Cerebellum_Cort_Vol,
    "Left Thalamus Proper" = L_ThalamusProper_Vol,
    "Left Caudate" = L_Caudate_Vol,
    "Left Putamen" = L_Putamen_Vol,
    "Left Pallidum" = L_Pallidum_Vol,
    "3rd Ventricle" = `3rdVent_Vol`,
    "4th Ventricle" = `4thVent_Vol`,
    "Brain Stem" = BrainStem_Vol,
    "Left Hippocampus" = L_Hippo_Vol,
    "Left Amygdala"= L_Amygdala_Vol,
    "CSF" = CSF_Vol,
    "Left Accumbens Area" = L_AccumbensArea_Vol,
    "Left Vent Diencephalon" = L_VentDC_Vol,
    "Left Vessel" = L_Vessel_Vol,
    "Left Choroid Plexus" = L_ChoroidPlexus_Vol,
    "Right Lat Ventricle"= R_LatVent_Vol,
    "Right Inf Lat Ventricle"= R_InfLatVent_Vol,
    "Right Cerebellum WM"=R_Cerebellum_WM_Vol,
    "Right Cerebellum Cortex" = R_Cerebellum_Cort_Vol,
    "Right Thalamus Proper" = R_ThalamusProper_Vol,
    "Right Caudate" = R_Caudate_Vol,
    "Right Putamen" = R_Putamen_Vol,
    "Right Pallidum" = R_Pallidum_Vol,
    "Right Hippocampus" = R_Hippo_Vol,
    "Right Amygdala"= R_Amygdala_Vol,
    "Right Accumbens Area" = R_AccumbensArea_Vol,
    "Right Vent Diencephalon"= R_VentDC_Vol,
    "Right Vessel" = R_Vessel_Vol,
    "Right Choroid Plexus"= R_ChoroidPlexus_Vol,
    "5th Ventricle" = `5thVent_Vol`,
    "Optic Chiasm" = OpticChiasm_Vol,
    "CC Posterior"= CC_Posterior_Vol,
    "CC MidPosterior"= CC_MidPosterior_Vol,
    "CC Central" = CC_Central_Vol,
    "CC MidAnterior" = CC_MidAnterior_Vol,
    "CC Anterior" = CC_Anterior_Vol)  %>%  tbl_summary(by = Racial_identity, statistic = list(all_continuous() ~ "{mean} ({sd})"), digits = all_continuous() ~ function(x) format(x, format = "e", digits = 4)) %>% add_difference() %>% add_q(method = "holm", pvalue_fun = function(x) style_pvalue(x, digits = 3)) %>%  as_gt()


```



### Graphs of brain volumetry with statistical significance after multiple comparisons analysis


```{r}
data_connectomehcp_filtered_paired_volumetry_wrap <- data_connectomehcp_filtered_paired_volumetry %>% dplyr::select(c(1,11,12,13,47,48,18,36))%>% dplyr::rename(
    "Cortical WM*"=Tot_WM_Vol,
    "Left Cortical WM*"= L_WM_Vol,
    "Right Cortical WM*"= R_WM_Vol,
    "Optic Chiasm***"=OpticChiasm_Vol,
    "CC Posterior*"= CC_Posterior_Vol,
    "Left Thalamus Proper*"= L_ThalamusProper_Vol,
    "Right Thalamus Proper*"= R_ThalamusProper_Vol,
 ) %>% gather(key = "volumetry", value = "cubic_milimeters_ICV", -Racial_identity)


plot_volumetry_paired_corrected_permutation_facet <- ggplot(data = data_connectomehcp_filtered_paired_volumetry_wrap, aes(y = cubic_milimeters_ICV , x = volumetry, fill = Racial_identity)) + 
geom_half_violin((aes(fill = factor(Racial_identity))),position = position_nudge(x = .6, y = 0), alpha = .8) +
 geom_boxplot(aes(y = cubic_milimeters_ICV , x = volumetry,fill=Racial_identity), position = position_dodge(.5), notch = TRUE,outlier.shape = NA, width= 0.3, alpha =0.4, show.legend = FALSE) +  stat_summary(aes(y = cubic_milimeters_ICV , x = volumetry,fill=Racial_identity),fun.y="mean",position = position_dodge(.5), show.legend = FALSE) +  geom_point((aes(colour = factor(Racial_identity))), position = position_jitterdodge(dodge.width = 0.55), size = .5, alpha = .8, show.legend = FALSE) + 
  #coord_cartesian(ylim=c(0,0.001)) + 
  facet_wrap(~volumetry, scales = "free") +
#expand_limits(x = 6) +
#guides(fill = TRUE) +
#guides(color = TRUE) +
#scale_color_manual(values=c("red", "blue")) +
scale_fill_discrete(labels = c("Whites", "African Americans")) +
#scale_color_brewer(palette = "Spectral") +
#scale_fill_brewer(palette = "Spectral") +
#coord_flip() +
theme_light(base_size = 12, base_family = "Arial") +
  #ggtitle("Volumetric results") 
   xlab("") + ylab(~~ mm^'3'/ ICV) + labs(fill = "") + labs(col = "")  + theme(legend.position = "top",axis.text.x=element_blank(), strip.text.x = element_text(color = "black", face = "bold"))  #+ geom_signif(comparisons = list(c("White", "Black or African Am.")),tip_length=0,y_position = 9, textsize = 4)


plot_volumetry_paired_corrected_permutation_facet



```




# 6. Brain cortical thickness analysis of paired sample t-test

```{r}
## Selection of brain cortical thickness and Racial identity variables


data_connectomehcp_filtered_paired_cortical_thickness <- data_connectomehcp_filtered_paired %>% select(c(2,6:73)) %>% dplyr::rename(
    L_Bankssts_Thck = FS_L_Bankssts_Thck,
    L_Caudalanteriorcingulate_Thck = FS_L_Caudalanteriorcingulate_Thck,
    L_Caudalmiddlefrontal_Thck = FS_L_Caudalmiddlefrontal_Thck,
    L_Cuneus_Thck = FS_L_Cuneus_Thck,
    L_Entorhinal_Thck = FS_L_Entorhinal_Thck,
    L_Fusiform_Thck = FS_L_Fusiform_Thck, 
    L_Inferiorparietal_Thck = FS_L_Inferiorparietal_Thck,
    L_Inferiortemporal_Thck = FS_L_Inferiortemporal_Thck,
    L_Isthmuscingulate_Thck = FS_L_Isthmuscingulate_Thck,
    L_Lateraloccipital_Thck = FS_L_Lateraloccipital_Thck,
    L_Lateralorbitofrontal_Thck = FS_L_Lateralorbitofrontal_Thck,
    L_Lingual_Thck  = FS_L_Lingual_Thck,
    L_Medialorbitofrontal_Thck = FS_L_Medialorbitofrontal_Thck,
    L_Middletemporal_Thck = FS_L_Middletemporal_Thck,
    L_Parahippocampal_Thck = FS_L_Parahippocampal_Thck,
    L_Paracentral_Thck = FS_L_Paracentral_Thck,
    L_Parsopercularis_Thck = FS_L_Parsopercularis_Thck,
    L_Parsorbitalis_Thck = FS_L_Parsorbitalis_Thck,
    L_Parstriangularis_Thck = FS_L_Parstriangularis_Thck,
    L_Pericalcarine_Thck = FS_L_Pericalcarine_Thck,
    L_Postcentral_Thck = FS_L_Postcentral_Thck,
    L_Posteriorcingulate_Thck = FS_L_Posteriorcingulate_Thck,
    L_Precentral_Thck = FS_L_Precentral_Thck,
    L_Precuneus_Thck = FS_L_Precuneus_Thck,
    L_Rostralanteriorcingulate_Thck = FS_L_Rostralanteriorcingulate_Thck,
    L_Rostralmiddlefrontal_Thck = FS_L_Rostralmiddlefrontal_Thck,
    L_Superiorfrontal_Thck = FS_L_Superiorfrontal_Thck,
    L_Superiorparietal_Thck = FS_L_Superiorparietal_Thck,
    L_Superiortemporal_Thck = FS_L_Superiortemporal_Thck,
    L_Supramarginal_Thck = FS_L_Supramarginal_Thck,
    L_Frontalpole_Thck = FS_L_Frontalpole_Thck,
    L_Temporalpole_Thck = FS_L_Temporalpole_Thck,
    L_Transversetemporal_Thck = FS_L_Transversetemporal_Thck,
    L_Insula_Thck = FS_L_Insula_Thck,
    R_Bankssts_Thck = FS_R_Bankssts_Thck,
    R_Caudalanteriorcingulate_Thck = FS_R_Caudalanteriorcingulate_Thck,
    R_Caudalmiddlefrontal_Thck = FS_R_Caudalmiddlefrontal_Thck,
    R_Cuneus_Thck = FS_R_Cuneus_Thck,
    R_Entorhinal_Thck = FS_R_Entorhinal_Thck,
    R_Fusiform_Thck = FS_R_Fusiform_Thck,
    R_Inferiorparietal_Thck = FS_R_Inferiorparietal_Thck,
    R_Inferiortemporal_Thck = FS_R_Inferiortemporal_Thck,
    R_Isthmuscingulate_Thck = FS_R_Isthmuscingulate_Thck,
    R_Lateraloccipital_Thck = FS_R_Lateraloccipital_Thck,
    R_Lateralorbitofrontal_Thck = FS_R_Lateralorbitofrontal_Thck,
    R_Lingual_Thck = FS_R_Lingual_Thck,
    R_Medialorbitofrontal_Thck = FS_R_Medialorbitofrontal_Thck,
    R_Middletemporal_Thck= FS_R_Middletemporal_Thck,
    R_Parahippocampal_Thck = FS_R_Parahippocampal_Thck,
    R_Paracentral_Thck = FS_R_Paracentral_Thck,
    R_Parsopercularis_Thck= FS_R_Parsopercularis_Thck,
    R_Parsorbitalis_Thck = FS_R_Parsorbitalis_Thck,
    R_Parstriangularis_Thck = FS_R_Parstriangularis_Thck,
    R_Pericalcarine_Thck = FS_R_Pericalcarine_Thck,
    R_Postcentral_Thck = FS_R_Postcentral_Thck,
    R_Posteriorcingulate_Thck = FS_R_Posteriorcingulate_Thck,
    R_Precentral_Thck = FS_R_Precentral_Thck,
    R_Precuneus_Thck = FS_R_Precuneus_Thck,
    R_Rostralanteriorcingulate_Thck = FS_R_Rostralanteriorcingulate_Thck,
    R_Rostralmiddlefrontal_Thck = FS_R_Rostralmiddlefrontal_Thck,
    R_Superiorfrontal_Thck = FS_R_Superiorfrontal_Thck,
    R_Superiorparietal_Thck = FS_R_Superiorparietal_Thck,
    R_Superiortemporal_Thck = FS_R_Superiortemporal_Thck,
    R_Supramarginal_Thck = FS_R_Supramarginal_Thck,
    R_Frontalpole_Thck = FS_R_Frontalpole_Thck,
    R_Temporalpole_Thck = FS_R_Temporalpole_Thck,                  
    R_Transversetemporal_Thck = FS_R_Transversetemporal_Thck,
    R_Insula_Thck = FS_R_Insula_Thck )



```

```{r}
## Welch t-test analysis with non-homogeneous of variance assumption

data_connectomehcp_filtered_paired_cortical_thickness_welcht_test  <- lapply(data_connectomehcp_filtered_paired_cortical_thickness[c(2:69)], function(x) t.test(x ~ data_connectomehcp_filtered_paired_cortical_thickness$Racial_identity, var.equal = FALSE))

data_connectomehcp_filtered_paired_cortical_thickness_welcht_test
```


##  Multiple comparisons correction Holm-Bonferroni method

```{r echo=TRUE}


# p-values Welch t-test analysis with non-homogeneous of variance assumption

pvalues_data_connectomehcp_filtered_paired_cortical_thickness_welcht_test <- sapply(data_connectomehcp_filtered_paired_cortical_thickness[c(2:69)], function(x) t.test(x ~ data_connectomehcp_filtered_paired_cortical_thickness$Racial_identity, var.equal = FALSE)$p.value)

pvalues_data_connectomehcp_filtered_paired_cortical_thickness_welcht_test<- as.data.frame(pvalues_data_connectomehcp_filtered_paired_cortical_thickness_welcht_test) %>% dplyr::rename(pvalue=pvalues_data_connectomehcp_filtered_paired_cortical_thickness_welcht_test) %>% dplyr::select(1)


## Execution of Holm-Bonferroni multiple comparison analysis 

pvalues_data_connectomehcp_filtered_paired_cortical_thickness_welcht_test$Holm =p.adjust(pvalues_data_connectomehcp_filtered_paired_cortical_thickness_welcht_test$pvalue,method ="holm") 

```

```{r echo=FALSE}
knitr::kable(pvalues_data_connectomehcp_filtered_paired_cortical_thickness_welcht_test, format = "simple", align = "c", col.names = c('p-values', 'Holm'))

pvalues_data_connectomehcp_filtered_paired_cortical_thickness_welcht_test %>% filter(Holm < 0.05)
```

### Table statistical summary of brain cortical thickness 

```{r}
data_connectomehcp_filtered_paired_cortical_thickness %>% 
dplyr::rename(
    "Left Banks STS" = L_Bankssts_Thck,
    "Left Caudal Anterior Cingulate" = L_Caudalanteriorcingulate_Thck,
    "Left Caudal Middle Frontal" = L_Caudalmiddlefrontal_Thck,
    "Left Cuneus" = L_Cuneus_Thck,
    "Left Entorhinal" = L_Entorhinal_Thck,
    "Left Fusiform" = L_Fusiform_Thck, 
    "Left Inferior Parietal" = L_Inferiorparietal_Thck,
    "Left Inferior Temporal" = L_Inferiortemporal_Thck,
    "Left Isthmuscingulate" = L_Isthmuscingulate_Thck,
    "Left Lateral Occipital" = L_Lateraloccipital_Thck,
    "Left Lateral Orbitofrontal" = L_Lateralorbitofrontal_Thck,
    "Left Lingual"  = L_Lingual_Thck,
    "Left Medialorbitofrontal" = L_Medialorbitofrontal_Thck,
    "Left Middletemporal" = L_Middletemporal_Thck,
    "Left Parahippocampal" = L_Parahippocampal_Thck,
    "Left Paracentral" = L_Paracentral_Thck,
    "Left Parsopercularis" = L_Parsopercularis_Thck,
    "Left Parsorbitalis" = L_Parsorbitalis_Thck,
    "Left Parstriangularis" = L_Parstriangularis_Thck,
    "Left Pericalcarine" = L_Pericalcarine_Thck,
    "Left Postcentral" = L_Postcentral_Thck,
    "Left Posterior Cingulate" = L_Posteriorcingulate_Thck,
    "Left Precentral" = L_Precentral_Thck,
    "Left Precuneus" = L_Precuneus_Thck,
    "Left Rostral anterior cingulate" = L_Rostralanteriorcingulate_Thck,
    "Left Rostral middle frontal" = L_Rostralmiddlefrontal_Thck,
    "Left Superior Frontal" = L_Superiorfrontal_Thck,
    "Left Superior Parietal" = L_Superiorparietal_Thck,
    "Left Superior Temporal" = L_Superiortemporal_Thck,
    "Left Supramarginal" = L_Supramarginal_Thck,
    "Left Frontal Pole" = L_Frontalpole_Thck,
    "Left Temporal Pole" = L_Temporalpole_Thck,
    "Left Transverse Temporal" = L_Transversetemporal_Thck,
    "Left Insula" = L_Insula_Thck,
    "Right Banks STS" = R_Bankssts_Thck,
    "Right Caudal Anterior Cingulate"= R_Caudalanteriorcingulate_Thck,
    "Right Caudal Middle Frontal" = R_Caudalmiddlefrontal_Thck,
    "Right Cuneus" = R_Cuneus_Thck,
    "Right Entorhinal" = R_Entorhinal_Thck,
    "Right Fusiform" = R_Fusiform_Thck,
    "Right Inferior Parietal" =R_Inferiorparietal_Thck,
    "Right Inferior Temporal" = R_Inferiortemporal_Thck,
    "Right Isthmuscingulate" = R_Isthmuscingulate_Thck,
    "Right Lateral Occipital" = R_Lateraloccipital_Thck,
    "Right Lateral Orbitofrontal" = R_Lateralorbitofrontal_Thck,
    "Right Lingual" = R_Lingual_Thck,
    "Right Medial Orbitofrontal" = R_Medialorbitofrontal_Thck,
    "Right Middle Temporal"= R_Middletemporal_Thck,
    "Right _Parahippocampal" = R_Parahippocampal_Thck,
    "Right Paracentral" = R_Paracentral_Thck,
    "Right Parsopercularis"= R_Parsopercularis_Thck,
    "Right Parsorbitalis" = R_Parsorbitalis_Thck,
    "Right Parstriangularis" = R_Parstriangularis_Thck,
    "Right Pericalcarine" = R_Pericalcarine_Thck,
    "Right Postcentral" = R_Postcentral_Thck,
    "Right Posterior Cingulate" = R_Posteriorcingulate_Thck,
    "Right Precentral" = R_Precentral_Thck,
    "Right Precuneus" = R_Precuneus_Thck,
    "Right Rostral Anterior Cingulate" = R_Rostralanteriorcingulate_Thck,
    "Right Rostral Middle Frontal" = R_Rostralmiddlefrontal_Thck,
    "Right Superior Frontal" = R_Superiorfrontal_Thck,
    "Right Superior Parietal" = R_Superiorparietal_Thck,
    "Right Superior Temporal" = R_Superiortemporal_Thck,
    "Right Supramarginal" = R_Supramarginal_Thck,
    "Right Frontal Pole" = R_Frontalpole_Thck,
    "Right Temporal Pole" = R_Temporalpole_Thck,                  
    "Right Transverse Temporal" = R_Transversetemporal_Thck,
    "Right Insula" = R_Insula_Thck ) %>%  tbl_summary(by = Racial_identity, statistic = list(all_continuous() ~ "{mean} ({sd})"), digits = all_continuous() ~ function(x) format(x, format = "e", digits = 4)) %>% add_difference() %>% add_q(method = "holm", pvalue_fun = function(x) style_pvalue(x, digits = 3)) %>%  as_gt()
```


### Graphs of brain cortical thickness with statistical significance after multiple comparisons analysis



```{r}

data_paired_cortical_thickness_plotted <- data_connectomehcp_filtered_paired_cortical_thickness %>% na.omit()   %>% dplyr::select(c(1,40,68,45))  %>% dplyr::rename(
    "Right Entorhinal*"= R_Entorhinal_Thck,
    "Right Transverse Temporal*"= R_Transversetemporal_Thck,   
    "Right Lateral Occipital*"= R_Lateraloccipital_Thck,
) %>% gather(key = "thickness", value = "milimeters", -Racial_identity)



plot_cortical_thickness_paired_permutation_facet <- ggplot(data = data_paired_cortical_thickness_plotted, aes(y = milimeters , x = thickness, fill = Racial_identity)) + 
geom_half_violin((aes(fill = factor(Racial_identity))),position = position_nudge(x = .6, y = 0), alpha = .8) +
 geom_boxplot(aes(y = milimeters , x = thickness,fill=Racial_identity), position = position_dodge(.5), notch = TRUE,outlier.shape = NA, width= 0.3, alpha =0.4, show.legend = FALSE) +  stat_summary(aes(y = milimeters , x = thickness,fill=Racial_identity),fun.y="mean",position = position_dodge(.5), show.legend = FALSE) +  geom_point((aes(colour = factor(Racial_identity))), position = position_jitterdodge(dodge.width = 0.55), size = .5, alpha = .8, show.legend = FALSE) + 
  #coord_cartesian(ylim=c(0,0.001)) + 
  facet_wrap(~thickness, scales = "free") +
#expand_limits(x = 6) +
#guides(fill = TRUE) +
#guides(color = TRUE) +
#scale_color_manual(values=c("red", "blue")) +
scale_fill_discrete(labels = c("Whites", "African Americans")) +
#scale_color_brewer(palette = "Spectral") +
#scale_fill_brewer(palette = "Spectral") +
#coord_flip() +
theme_light(base_size = 12, base_family = "Arial") +
  #ggtitle("Cortical Thickness Results") +
  xlab("") + ylab("Thickness (mm)") + labs(fill = "") + labs(col = "")  + theme(legend.position = "top",axis.text.x=element_blank(), strip.text.x = element_text(color = "black", face = "bold"))  #+ geom_signif(comparisons = list(c("White", "Black or African Am.")),tip_length=0,y_position = 9, textsize = 4)

  plot_cortical_thickness_paired_permutation_facet
```

# 7. Brain cortical surface area analysis of paired sample t-test

```{r}
## Selection of brain cortical thickness and Racial identity variables


data_connectomehcp_filtered_paired_cortical_surface <- data_connectomehcp_filtered_paired %>% select(c(2,74:141)) %>%  dplyr::rename(
     L_Bankssts_Area = FS_L_Bankssts_Area,
    L_Caudalanteriorcingulate_Area = FS_L_Caudalanteriorcingulate_Area,
    L_Caudalmiddlefrontal_Area = FS_L_Caudalmiddlefrontal_Area,
    L_Cuneus_Area = FS_L_Cuneus_Area,
    L_Entorhinal_Area = FS_L_Entorhinal_Area,
    L_Fusiform_Area = FS_L_Fusiform_Area, 
    L_Inferiorparietal_Area = FS_L_Inferiorparietal_Area, 
    L_Inferiortemporal_Area = FS_L_Inferiortemporal_Area, 
    L_Isthmuscingulate_Area = FS_L_Isthmuscingulate_Area,
    L_Lateraloccipital_Area = FS_L_Lateraloccipital_Area,
    L_Lateralorbitofrontal_Area = FS_L_Lateralorbitofrontal_Area,
    L_Lingual_Area = FS_L_Lingual_Area,
    L_Medialorbitofrontal_Area = FS_L_Medialorbitofrontal_Area,
    L_Middletemporal_Area = FS_L_Middletemporal_Area,
    L_Parahippocampal_Area = FS_L_Parahippocampal_Area,
    L_Paracentral_Area = FS_L_Paracentral_Area,
    L_Parsopercularis_Area = FS_L_Parsopercularis_Area,
    L_Parsorbitalis_Area = FS_L_Parsorbitalis_Area,
    L_Parstriangularis_Area = FS_L_Parstriangularis_Area,
    L_Pericalcarine_Area = FS_L_Pericalcarine_Area,
    L_Postcentral_Area = FS_L_Postcentral_Area,
    L_Posteriorcingulate_Area = FS_L_Posteriorcingulate_Area,
    L_Precentral_Area = FS_L_Precentral_Area,
    L_Precuneus_Area = FS_L_Precuneus_Area,
    L_Rostralanteriorcingulate_Area = FS_L_Rostralanteriorcingulate_Area,
    L_Rostralmiddlefrontal_Area = FS_L_Rostralmiddlefrontal_Area,
    L_Superiorfrontal_Area = FS_L_Superiorfrontal_Area,
    L_Superiorparietal_Area = FS_L_Superiorparietal_Area,
    L_Superiortemporal_Area = FS_L_Superiortemporal_Area,
    L_Supramarginal_Area = FS_L_Supramarginal_Area,
    L_Frontalpole_Area = FS_L_Frontalpole_Area,
    L_Temporalpole_Area = FS_L_Temporalpole_Area,
    L_Transversetemporal_Area = FS_L_Transversetemporal_Area,
    L_Insula_Area = FS_L_Insula_Area,
    R_Bankssts_Area = FS_R_Bankssts_Area,
    R_Caudalanteriorcingulate_Area = FS_R_Caudalanteriorcingulate_Area,
    R_Caudalmiddlefrontal_Area = FS_R_Caudalmiddlefrontal_Area,
    R_Cuneus_Area = FS_R_Cuneus_Area,
    R_Entorhinal_Area = FS_R_Entorhinal_Area,
    R_Fusiform_Area= FS_R_Fusiform_Area,
    R_Inferiorparietal_Area = FS_R_Inferiorparietal_Area,
    R_Inferiortemporal_Area = FS_R_Inferiortemporal_Area,
    R_Isthmuscingulate_Area = FS_R_Isthmuscingulate_Area,
    R_Lateraloccipital_Area = FS_R_Lateraloccipital_Area,
    R_Lateralorbitofrontal_Area = FS_R_Lateralorbitofrontal_Area,
    R_Lingual_Area = FS_R_Lingual_Area,
    R_Medialorbitofrontal_Area = FS_R_Medialorbitofrontal_Area,
    R_Middletemporal_Area = FS_R_Middletemporal_Area,
    R_Parahippocampal_Area = FS_R_Parahippocampal_Area,
    R_Paracentral_Area = FS_R_Paracentral_Area,
    R_Parsopercularis_Area = FS_R_Parsopercularis_Area,
    R_Parsorbitalis_Area = FS_R_Parsorbitalis_Area,
    R_Parstriangularis_Area = FS_R_Parstriangularis_Area,
    R_Pericalcarine_Area = FS_R_Pericalcarine_Area,
    R_Postcentral_Area = FS_R_Postcentral_Area,
    R_Posteriorcingulate_Area = FS_R_Posteriorcingulate_Area,            
    R_Precuneus_Area = FS_R_Precuneus_Area,
    R_Precentral_Area = FS_R_Precentral_Area,
    R_Rostralanteriorcingulate_Area = FS_R_Rostralanteriorcingulate_Area,
    R_Rostralmiddlefrontal_Area = FS_R_Rostralmiddlefrontal_Area,
    R_Superiorfrontal_Area = FS_R_Superiorfrontal_Area,
    R_Superiorparietal_Area = FS_R_Superiorparietal_Area,
    R_Superiortemporal_Area = FS_R_Superiortemporal_Area, 
    R_Supramarginal_Area = FS_R_Supramarginal_Area,
    R_Frontalpole_Area = FS_R_Frontalpole_Area,
    R_Temporalpole_Area = FS_R_Temporalpole_Area,
    R_Transversetemporal_Area = FS_R_Transversetemporal_Area,            
    R_Insula_Area = FS_R_Insula_Area)


```

```{r}
## Welch t-test analysis with non-homogeneous of variance assumption

data_connectomehcp_filtered_paired_cortical_surface_welcht_test  <- lapply(data_connectomehcp_filtered_paired_cortical_surface[c(2:69)], function(x) t.test(x ~ data_connectomehcp_filtered_paired_cortical_surface$Racial_identity, var.equal = FALSE))

data_connectomehcp_filtered_paired_cortical_surface_welcht_test
```


##  Multiple comparisons correction Holm-Bonferroni method

```{r echo=TRUE}


# p-values Welch t-test analysis with non-homogeneous of variance assumption

pvalues_data_connectomehcp_filtered_paired_cortical_surface_welcht_test <- sapply(data_connectomehcp_filtered_paired_cortical_surface[c(2:69)], function(x) t.test(x ~ data_connectomehcp_filtered_paired_cortical_surface$Racial_identity, var.equal = FALSE)$p.value)

pvalues_data_connectomehcp_filtered_paired_cortical_surface_welcht_test<- as.data.frame(pvalues_data_connectomehcp_filtered_paired_cortical_surface_welcht_test) %>% dplyr::rename(pvalue=pvalues_data_connectomehcp_filtered_paired_cortical_surface_welcht_test) %>% dplyr::select(1)



## Execution of Holm-Bonferroni multiple comparison analysis 

pvalues_data_connectomehcp_filtered_paired_cortical_surface_welcht_test$Holm =p.adjust(pvalues_data_connectomehcp_filtered_paired_cortical_surface_welcht_test$pvalue,method ="holm") 

```

```{r echo=FALSE}
knitr::kable(pvalues_data_connectomehcp_filtered_paired_cortical_surface_welcht_test, format = "simple", align = "c", col.names = c('p-values', 'Holm'))


pvalues_data_connectomehcp_filtered_paired_cortical_surface_welcht_test %>% filter(Holm <0.05)
```

### Table statistical summary of brain surface area 

```{r}
data_connectomehcp_filtered_paired_cortical_surface %>% 
dplyr::rename(
    "Left Banks STS" = L_Bankssts_Area,
    "Left Caudal Anterior Cingulate" = L_Caudalanteriorcingulate_Area,
    "Left Caudal Middle Frontal" = L_Caudalmiddlefrontal_Area,
    "Left Cuneus" = L_Cuneus_Area,
    "Left Entorhinal" = L_Entorhinal_Area,
    "Left Fusiform" = L_Fusiform_Area, 
    "Left Inferior Parietal" = L_Inferiorparietal_Area,
    "Left Inferior Temporal" = L_Inferiortemporal_Area,
    "Left Isthmuscingulate" = L_Isthmuscingulate_Area,
    "Left Lateral Occipital" = L_Lateraloccipital_Area,
    "Left Lateral Orbitofrontal" = L_Lateralorbitofrontal_Area,
    "Left Lingual"  = L_Lingual_Area,
    "Left Medialorbitofrontal" = L_Medialorbitofrontal_Area,
    "Left Middletemporal" = L_Middletemporal_Area,
    "Left Parahippocampal" = L_Parahippocampal_Area,
    "Left Paracentral" = L_Paracentral_Area,
    "Left Parsopercularis" = L_Parsopercularis_Area,
    "Left Parsorbitalis" = L_Parsorbitalis_Area,
    "Left Parstriangularis" = L_Parstriangularis_Area,
    "Left Pericalcarine" = L_Pericalcarine_Area,
    "Left Postcentral" = L_Postcentral_Area,
    "Left Posterior Cingulate" = L_Posteriorcingulate_Area,
    "Left Precentral" = L_Precentral_Area,
    "Left Precuneus" = L_Precuneus_Area,
    "Left Rostral anterior cingulate" = L_Rostralanteriorcingulate_Area,
    "Left Rostral middle frontal" = L_Rostralmiddlefrontal_Area,
    "Left Superior Frontal" = L_Superiorfrontal_Area,
    "Left Superior Parietal" = L_Superiorparietal_Area,
    "Left Superior Temporal" = L_Superiortemporal_Area,
    "Left Supramarginal" = L_Supramarginal_Area,
    "Left Frontal Pole" = L_Frontalpole_Area,
    "Left Temporal Pole" = L_Temporalpole_Area,
    "Left Transverse Temporal" = L_Transversetemporal_Area,
    "Left Insula" = L_Insula_Area,
    "Right Banks STS" = R_Bankssts_Area,
    "Right Caudal Anterior Cingulate"= R_Caudalanteriorcingulate_Area,
    "Right Caudal Middle Frontal" = R_Caudalmiddlefrontal_Area,
    "Right Cuneus" = R_Cuneus_Area,
    "Right Entorhinal" = R_Entorhinal_Area,
    "Right Fusiform" = R_Fusiform_Area,
    "Right Inferior Parietal" =R_Inferiorparietal_Area,
    "Right Inferior Temporal" = R_Inferiortemporal_Area,
    "Right Isthmuscingulate" = R_Isthmuscingulate_Area,
    "Right Lateral Occipital" = R_Lateraloccipital_Area,
    "Right Lateral Orbitofrontal" = R_Lateralorbitofrontal_Area,
    "Right Lingual" = R_Lingual_Area,
    "Right Medial Orbitofrontal" = R_Medialorbitofrontal_Area,
    "Right Middle Temporal"= R_Middletemporal_Area,
    "Right Parahippocampal" = R_Parahippocampal_Area,
    "Right Paracentral" = R_Paracentral_Area,
    "Right Parsopercularis"= R_Parsopercularis_Area,
    "Right Parsorbitalis" = R_Parsorbitalis_Area,
    "Right Parstriangularis" = R_Parstriangularis_Area,
    "Right Pericalcarine" = R_Pericalcarine_Area,
    "Right Postcentral" = R_Postcentral_Area,
    "Right Posterior Cingulate" = R_Posteriorcingulate_Area,
    "Right Precentral" = R_Precentral_Area,
    "Right Precuneus" = R_Precuneus_Area,
    "Right Rostral Anterior Cingulate" = R_Rostralanteriorcingulate_Area,
    "Right Rostral Middle Frontal" = R_Rostralmiddlefrontal_Area,
    "Right Superior Frontal" = R_Superiorfrontal_Area,
    "Right Superior Parietal" = R_Superiorparietal_Area,
    "Right Superior Temporal" = R_Superiortemporal_Area,
    "Right Supramarginal" = R_Supramarginal_Area,
    "Right Frontal Pole" = R_Frontalpole_Area,
    "Right Temporal Pole" = R_Temporalpole_Area,                  
    "Right Transverse Temporal" = R_Transversetemporal_Area,
    "Right Insula" = R_Insula_Area ) %>%  tbl_summary(by = Racial_identity, statistic = list(all_continuous() ~ "{mean} ({sd})"), digits = all_continuous() ~ function(x) format(x, format = "e", digits = 5)) %>% add_difference() %>% add_q(method = "holm", pvalue_fun = function(x) style_pvalue(x, digits = 3)) %>%  as_gt()
```
